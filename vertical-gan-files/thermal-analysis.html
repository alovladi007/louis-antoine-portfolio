<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vertical GaN Thermal Analysis</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #0a0a0a;
            color: #e0e0e0;
            line-height: 1.6;
        }

        /* Navigation Bar */
        .navigation-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            border-bottom: 1px solid rgba(59, 130, 246, 0.3);
        }

        .nav-btn {
            background: linear-gradient(135deg, #3b82f6, #1e40af);
            color: white;
            padding: 0.5rem 1.5rem;
            border-radius: 8px;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);
        }

        /* Main Container */
        .main-container {
            margin-top: 80px;
            padding: 2rem;
            max-width: 1600px;
            margin-left: auto;
            margin-right: auto;
        }

        .page-title {
            font-size: 2.5rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 3rem;
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Control Panel */
        .control-panel {
            background: rgba(20, 20, 20, 0.8);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .control-section {
            margin-bottom: 2rem;
        }

        .control-section h3 {
            color: #60a5fa;
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        .control-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .control-item {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .control-item label {
            color: #a0a0a0;
            font-size: 0.9rem;
        }

        .control-item input[type="range"] {
            width: 100%;
            height: 6px;
            background: rgba(59, 130, 246, 0.2);
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
        }

        .control-item input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: #3b82f6;
            border-radius: 50%;
            cursor: pointer;
        }

        .control-item select {
            background: rgba(30, 30, 30, 0.8);
            color: #e0e0e0;
            border: 1px solid rgba(59, 130, 246, 0.3);
            padding: 0.5rem;
            border-radius: 5px;
            font-size: 0.9rem;
        }

        .value-display {
            color: #3b82f6;
            font-weight: 600;
            font-size: 0.9rem;
        }

        /* Visualization Container */
        .visualization-container {
            background: rgba(20, 20, 20, 0.8);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .viz-title {
            color: #60a5fa;
            font-size: 1.5rem;
            margin-bottom: 1rem;
            text-align: center;
        }

        /* Results Grid */
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .result-card {
            background: rgba(59, 130, 246, 0.05);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 10px;
            padding: 1.5rem;
            text-align: center;
        }

        .result-value {
            font-size: 2rem;
            font-weight: bold;
            color: #3b82f6;
            margin-bottom: 0.5rem;
        }

        .result-label {
            color: #a0a0a0;
            font-size: 0.9rem;
        }

        /* Info Box */
        .info-box {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 10px;
            padding: 1.5rem;
            margin: 2rem 0;
        }

        .info-box h4 {
            color: #60a5fa;
            margin-bottom: 1rem;
        }

        .info-box p {
            color: #c0c0c0;
            line-height: 1.8;
        }

        /* Button */
        .btn {
            background: linear-gradient(135deg, #3b82f6, #1e40af);
            color: white;
            border: none;
            padding: 0.75rem 2rem;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .page-title {
                font-size: 2rem;
            }

            .control-grid {
                grid-template-columns: 1fr;
            }

            .results-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <div class="navigation-bar">
        <a href="performance-comparison.html" class="nav-btn">
            <i class="fas fa-arrow-left"></i> Previous Demo
        </a>
        <h2 style="color: #3b82f6; margin: 0;">Thermal Analysis</h2>
        <a href="field-distribution.html" class="nav-btn">
            Next Demo <i class="fas fa-arrow-right"></i>
        </a>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <h1 class="page-title">Vertical GaN Thermal Analysis</h1>

        <!-- Control Panel -->
        <div class="control-panel">
            <div class="control-section">
                <h3>Device Parameters</h3>
                <div class="control-grid">
                    <div class="control-item">
                        <label>Power Dissipation (W)</label>
                        <input type="range" id="power" min="1" max="100" step="1" value="25">
                        <span class="value-display" id="power-value">25 W</span>
                    </div>
                    <div class="control-item">
                        <label>Active Area (mm²)</label>
                        <input type="range" id="area" min="1" max="25" step="0.5" value="9">
                        <span class="value-display" id="area-value">9 mm²</span>
                    </div>
                    <div class="control-item">
                        <label>GaN Substrate Thickness (μm)</label>
                        <input type="range" id="substrate-thickness" min="100" max="500" step="10" value="300">
                        <span class="value-display" id="substrate-thickness-value">300 μm</span>
                    </div>
                    <div class="control-item">
                        <label>Ambient Temperature (°C)</label>
                        <input type="range" id="ambient" min="0" max="85" step="5" value="25">
                        <span class="value-display" id="ambient-value">25 °C</span>
                    </div>
                </div>
            </div>

            <div class="control-section">
                <h3>Cooling Configuration</h3>
                <div class="control-grid">
                    <div class="control-item">
                        <label>Heat Sink Type</label>
                        <select id="heatsink-type">
                            <option value="air">Air Cooled</option>
                            <option value="liquid">Liquid Cooled</option>
                            <option value="vapor">Vapor Chamber</option>
                            <option value="direct">Direct Bond Copper</option>
                        </select>
                    </div>
                    <div class="control-item">
                        <label>TIM Thickness (μm)</label>
                        <input type="range" id="tim-thickness" min="10" max="100" step="5" value="25">
                        <span class="value-display" id="tim-thickness-value">25 μm</span>
                    </div>
                    <div class="control-item">
                        <label>Heat Transfer Coefficient (W/m²K)</label>
                        <input type="range" id="htc" min="100" max="10000" step="100" value="1000">
                        <span class="value-display" id="htc-value">1000 W/m²K</span>
                    </div>
                    <div class="control-item">
                        <label>Comparison Mode</label>
                        <select id="comparison-mode">
                            <option value="both">Lateral vs Vertical</option>
                            <option value="vertical">Vertical Only</option>
                            <option value="lateral">Lateral Only</option>
                        </select>
                    </div>
                </div>
            </div>

            <button class="btn" onclick="updateThermalAnalysis()">
                <i class="fas fa-sync-alt"></i> Update Analysis
            </button>
        </div>

        <!-- Temperature Distribution -->
        <div class="visualization-container">
            <h3 class="viz-title">3D Temperature Distribution</h3>
            <div id="temp-distribution-3d" style="height: 500px;"></div>
        </div>

        <!-- Heat Flow Visualization -->
        <div class="visualization-container">
            <h3 class="viz-title">Heat Flow Patterns</h3>
            <div id="heat-flow" style="height: 400px;"></div>
        </div>

        <!-- Thermal Resistance Network -->
        <div class="visualization-container">
            <h3 class="viz-title">Thermal Resistance Network</h3>
            <div id="thermal-network" style="height: 400px;"></div>
        </div>

        <!-- Transient Response -->
        <div class="visualization-container">
            <h3 class="viz-title">Transient Thermal Response</h3>
            <div id="transient-response" style="height: 400px;"></div>
        </div>

        <!-- Results Display -->
        <div class="visualization-container">
            <h3 class="viz-title">Thermal Performance Metrics</h3>
            <div class="results-grid">
                <div class="result-card">
                    <div class="result-value" id="tj-value">125</div>
                    <div class="result-label">Junction Temp (°C)</div>
                </div>
                <div class="result-card">
                    <div class="result-value" id="rth-value">2.5</div>
                    <div class="result-label">Total Rth (K/W)</div>
                </div>
                <div class="result-card">
                    <div class="result-value" id="margin-value">50</div>
                    <div class="result-label">Thermal Margin (°C)</div>
                </div>
                <div class="result-card">
                    <div class="result-value" id="gradient-value">35</div>
                    <div class="result-label">Max Gradient (K/mm)</div>
                </div>
            </div>
        </div>

        <!-- Information Section -->
        <div class="info-box">
            <h4>Thermal Advantages of Vertical GaN</h4>
            <p>
                Vertical GaN devices offer superior thermal performance compared to lateral architectures. 
                The key advantage is heat dissipation through the GaN substrate, providing a direct thermal 
                path to the heat sink. This eliminates the thermal bottleneck present in lateral devices 
                where heat must flow through insulating layers.
            </p>
            <p style="margin-top: 1rem;">
                The 3D current flow in vertical devices also distributes heat generation more uniformly 
                throughout the device volume, reducing hot spots and improving reliability. Combined with 
                advanced packaging techniques, vertical GaN can achieve junction-to-case thermal resistances 
                below 0.5 K/W.
            </p>
        </div>
    </div>

    <script>
        // Initialize range inputs
        document.querySelectorAll('input[type="range"]').forEach(input => {
            input.addEventListener('input', function() {
                const valueDisplay = document.getElementById(this.id + '-value');
                let value = this.value;
                
                switch(this.id) {
                    case 'power':
                        valueDisplay.textContent = value + ' W';
                        break;
                    case 'area':
                        valueDisplay.textContent = value + ' mm²';
                        break;
                    case 'substrate-thickness':
                    case 'tim-thickness':
                        valueDisplay.textContent = value + ' μm';
                        break;
                    case 'ambient':
                        valueDisplay.textContent = value + ' °C';
                        break;
                    case 'htc':
                        valueDisplay.textContent = value + ' W/m²K';
                        break;
                }
            });
        });

        function updateThermalAnalysis() {
            const power = parseFloat(document.getElementById('power').value);
            const area = parseFloat(document.getElementById('area').value);
            const substrateThickness = parseFloat(document.getElementById('substrate-thickness').value);
            const ambient = parseFloat(document.getElementById('ambient').value);
            const timThickness = parseFloat(document.getElementById('tim-thickness').value);
            const htc = parseFloat(document.getElementById('htc').value);
            const heatsinkType = document.getElementById('heatsink-type').value;
            const comparisonMode = document.getElementById('comparison-mode').value;

            // Update all visualizations
            plot3DTemperatureDistribution(power, area, substrateThickness);
            plotHeatFlow(power, area, comparisonMode);
            plotThermalNetwork(substrateThickness, timThickness, heatsinkType);
            plotTransientResponse(power, area);
            
            // Update metrics
            updateThermalMetrics(power, area, substrateThickness, ambient, timThickness, htc);
        }

        function plot3DTemperatureDistribution(power, area, thickness) {
            // Generate 3D temperature data
            const size = 20;
            const x = [];
            const y = [];
            const z = [];
            const temp = [];
            
            const powerDensity = power / area;
            const sideLength = Math.sqrt(area);
            
            for (let i = 0; i < size; i++) {
                for (let j = 0; j < size; j++) {
                    for (let k = 0; k < size; k++) {
                        const xPos = (i - size/2) * sideLength / size;
                        const yPos = (j - size/2) * sideLength / size;
                        const zPos = -k * thickness / size / 1000; // Convert to mm
                        
                        x.push(xPos);
                        y.push(yPos);
                        z.push(zPos);
                        
                        // Temperature calculation based on distance from heat source
                        const r = Math.sqrt(xPos*xPos + yPos*yPos);
                        const tempDrop = powerDensity * 10 * Math.exp(-r/sideLength) * (1 - k/size);
                        temp.push(25 + tempDrop);
                    }
                }
            }
            
            const data = [{
                type: 'scatter3d',
                mode: 'markers',
                x: x,
                y: y,
                z: z,
                marker: {
                    size: 3,
                    color: temp,
                    colorscale: 'Hot',
                    showscale: true,
                    colorbar: {
                        title: 'Temperature (°C)',
                        titleside: 'right'
                    }
                },
                text: temp.map(t => `Temp: ${t.toFixed(1)}°C`),
                hoverinfo: 'text'
            }];
            
            const layout = {
                title: 'Temperature Distribution in Vertical GaN Device',
                scene: {
                    xaxis: { title: 'X (mm)' },
                    yaxis: { title: 'Y (mm)' },
                    zaxis: { title: 'Z (mm)' },
                    camera: {
                        eye: { x: 1.5, y: 1.5, z: 1.5 }
                    }
                },
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#e0e0e0' }
            };
            
            Plotly.newPlot('temp-distribution-3d', data, layout, {responsive: true});
        }

        function plotHeatFlow(power, area, mode) {
            const positions = Array.from({length: 50}, (_, i) => i * 0.02);
            
            // Heat flux calculations
            const verticalFlux = positions.map(z => power / area * Math.exp(-z * 10));
            const lateralFlux = positions.map(z => power / area * Math.exp(-z * 50) * 0.3);
            
            const data = [];
            
            if (mode === 'both' || mode === 'vertical') {
                data.push({
                    x: positions,
                    y: verticalFlux,
                    name: 'Vertical GaN',
                    type: 'scatter',
                    line: { color: '#3b82f6', width: 3 },
                    fill: 'tozeroy',
                    fillcolor: 'rgba(59, 130, 246, 0.2)'
                });
            }
            
            if (mode === 'both' || mode === 'lateral') {
                data.push({
                    x: positions,
                    y: lateralFlux,
                    name: 'Lateral GaN',
                    type: 'scatter',
                    line: { color: '#60a5fa', width: 3 },
                    fill: 'tozeroy',
                    fillcolor: 'rgba(96, 165, 250, 0.2)'
                });
            }
            
            const layout = {
                title: 'Heat Flux Distribution',
                xaxis: { 
                    title: 'Distance from Junction (mm)',
                    gridcolor: '#333'
                },
                yaxis: { 
                    title: 'Heat Flux (W/mm²)',
                    gridcolor: '#333'
                },
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(20,20,20,0.8)',
                font: { color: '#e0e0e0' },
                showlegend: true
            };
            
            Plotly.newPlot('heat-flow', data, layout, {responsive: true});
        }

        function plotThermalNetwork(substrateThickness, timThickness, heatsinkType) {
            // Thermal resistance values
            const rthJunction = 0.1;
            const rthSubstrate = 0.001 * substrateThickness;
            const rthTIM = 0.002 * timThickness;
            
            let rthHeatsink;
            switch(heatsinkType) {
                case 'air': rthHeatsink = 2.0; break;
                case 'liquid': rthHeatsink = 0.5; break;
                case 'vapor': rthHeatsink = 0.3; break;
                case 'direct': rthHeatsink = 0.2; break;
            }
            
            const categories = ['Junction', 'Substrate', 'TIM', 'Heat Sink'];
            const verticalRth = [rthJunction, rthSubstrate, rthTIM, rthHeatsink];
            const lateralRth = [rthJunction * 1.5, rthSubstrate * 3, rthTIM * 1.5, rthHeatsink];
            
            const data = [
                {
                    x: categories,
                    y: verticalRth,
                    name: 'Vertical GaN',
                    type: 'bar',
                    marker: { color: '#3b82f6' }
                },
                {
                    x: categories,
                    y: lateralRth,
                    name: 'Lateral GaN',
                    type: 'bar',
                    marker: { color: '#60a5fa' }
                }
            ];
            
            const layout = {
                title: 'Thermal Resistance Breakdown',
                xaxis: { gridcolor: '#333' },
                yaxis: { 
                    title: 'Thermal Resistance (K/W)',
                    gridcolor: '#333'
                },
                barmode: 'group',
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(20,20,20,0.8)',
                font: { color: '#e0e0e0' }
            };
            
            Plotly.newPlot('thermal-network', data, layout, {responsive: true});
        }

        function plotTransientResponse(power, area) {
            const time = Array.from({length: 100}, (_, i) => i * 0.01);
            
            // Thermal time constants
            const tau1_vertical = 0.05;
            const tau2_vertical = 0.5;
            const tau1_lateral = 0.08;
            const tau2_lateral = 0.8;
            
            const verticalResponse = time.map(t => 
                power * (0.3 * (1 - Math.exp(-t/tau1_vertical)) + 0.7 * (1 - Math.exp(-t/tau2_vertical)))
            );
            
            const lateralResponse = time.map(t => 
                power * (0.4 * (1 - Math.exp(-t/tau1_lateral)) + 0.6 * (1 - Math.exp(-t/tau2_lateral)))
            );
            
            const data = [
                {
                    x: time,
                    y: verticalResponse,
                    name: 'Vertical GaN',
                    type: 'scatter',
                    line: { color: '#3b82f6', width: 3 }
                },
                {
                    x: time,
                    y: lateralResponse,
                    name: 'Lateral GaN',
                    type: 'scatter',
                    line: { color: '#60a5fa', width: 3 }
                }
            ];
            
            const layout = {
                title: 'Transient Thermal Response',
                xaxis: { 
                    title: 'Time (s)',
                    gridcolor: '#333',
                    type: 'log'
                },
                yaxis: { 
                    title: 'Temperature Rise (°C)',
                    gridcolor: '#333'
                },
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(20,20,20,0.8)',
                font: { color: '#e0e0e0' }
            };
            
            Plotly.newPlot('transient-response', data, layout, {responsive: true});
        }

        function updateThermalMetrics(power, area, substrateThickness, ambient, timThickness, htc) {
            // Calculate thermal resistances
            const rthJunction = 0.1;
            const rthSubstrate = 0.001 * substrateThickness;
            const rthTIM = 0.002 * timThickness;
            const rthConvection = 1000 / (htc * area);
            
            const rthTotal = rthJunction + rthSubstrate + rthTIM + rthConvection;
            const Tj = ambient + power * rthTotal;
            const margin = 175 - Tj; // Max operating temp
            const gradient = power / (area * substrateThickness / 1000);
            
            // Update display
            document.getElementById('tj-value').textContent = Tj.toFixed(0);
            document.getElementById('rth-value').textContent = rthTotal.toFixed(2);
            document.getElementById('margin-value').textContent = margin.toFixed(0);
            document.getElementById('gradient-value').textContent = gradient.toFixed(0);
        }

        // Initial analysis
        updateThermalAnalysis();
    </script>
</body>
</html>