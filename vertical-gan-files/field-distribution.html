<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Electric Field Distribution - Vertical GaN</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #0a0a0a;
            color: #e0e0e0;
            line-height: 1.6;
        }

        /* Navigation Bar */
        .navigation-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            border-bottom: 1px solid rgba(59, 130, 246, 0.3);
        }

        .nav-btn {
            background: linear-gradient(135deg, #3b82f6, #1e40af);
            color: white;
            padding: 0.5rem 1.5rem;
            border-radius: 8px;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);
        }

        /* Main Container */
        .main-container {
            margin-top: 80px;
            padding: 2rem;
            max-width: 1600px;
            margin-left: auto;
            margin-right: auto;
        }

        .page-title {
            font-size: 2.5rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 3rem;
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Control Panel */
        .control-panel {
            background: rgba(20, 20, 20, 0.8);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .control-section {
            margin-bottom: 2rem;
        }

        .control-section h3 {
            color: #60a5fa;
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }

        .control-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .control-item {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .control-item label {
            color: #a0a0a0;
            font-size: 0.9rem;
        }

        .control-item input[type="range"] {
            width: 100%;
            height: 6px;
            background: rgba(59, 130, 246, 0.2);
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
        }

        .control-item input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: #3b82f6;
            border-radius: 50%;
            cursor: pointer;
        }

        .control-item select {
            background: rgba(30, 30, 30, 0.8);
            color: #e0e0e0;
            border: 1px solid rgba(59, 130, 246, 0.3);
            padding: 0.5rem;
            border-radius: 5px;
            font-size: 0.9rem;
        }

        .value-display {
            color: #3b82f6;
            font-weight: 600;
            font-size: 0.9rem;
        }

        /* Visualization Container */
        .visualization-container {
            background: rgba(20, 20, 20, 0.8);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .viz-title {
            color: #60a5fa;
            font-size: 1.5rem;
            margin-bottom: 1rem;
            text-align: center;
        }

        /* Results Grid */
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .result-card {
            background: rgba(59, 130, 246, 0.05);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 10px;
            padding: 1.5rem;
            text-align: center;
        }

        .result-value {
            font-size: 2rem;
            font-weight: bold;
            color: #3b82f6;
            margin-bottom: 0.5rem;
        }

        .result-label {
            color: #a0a0a0;
            font-size: 0.9rem;
        }

        /* Info Box */
        .info-box {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 10px;
            padding: 1.5rem;
            margin: 2rem 0;
        }

        .info-box h4 {
            color: #60a5fa;
            margin-bottom: 1rem;
        }

        /* Equation Box */
        .equation-box {
            background: rgba(30, 30, 30, 0.8);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1rem 0;
            text-align: center;
        }

        /* Button */
        .btn {
            background: linear-gradient(135deg, #3b82f6, #1e40af);
            color: white;
            border: none;
            padding: 0.75rem 2rem;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .page-title {
                font-size: 2rem;
            }

            .control-grid {
                grid-template-columns: 1fr;
            }

            .results-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <div class="navigation-bar">
        <a href="thermal-analysis.html" class="nav-btn">
            <i class="fas fa-arrow-left"></i> Previous Demo
        </a>
        <h2 style="color: #3b82f6; margin: 0;">Electric Field Distribution</h2>
        <a href="circuit-simulator.html" class="nav-btn">
            Next Demo <i class="fas fa-arrow-right"></i>
        </a>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <h1 class="page-title">Electric Field Distribution in Vertical GaN</h1>

        <!-- Control Panel -->
        <div class="control-panel">
            <div class="control-section">
                <h3>Device Parameters</h3>
                <div class="control-grid">
                    <div class="control-item">
                        <label>Applied Voltage (V)</label>
                        <input type="range" id="voltage" min="100" max="1500" step="50" value="800">
                        <span class="value-display" id="voltage-value">800 V</span>
                    </div>
                    <div class="control-item">
                        <label>Drift Layer Thickness (μm)</label>
                        <input type="range" id="drift-thickness" min="5" max="20" step="0.5" value="10">
                        <span class="value-display" id="drift-thickness-value">10 μm</span>
                    </div>
                    <div class="control-item">
                        <label>Drift Layer Doping (cm⁻³)</label>
                        <input type="range" id="doping" min="15" max="17" step="0.1" value="16">
                        <span class="value-display" id="doping-value">1.0e16</span>
                    </div>
                    <div class="control-item">
                        <label>Junction Temperature (°C)</label>
                        <input type="range" id="temperature" min="25" max="175" step="5" value="100">
                        <span class="value-display" id="temperature-value">100 °C</span>
                    </div>
                </div>
            </div>

            <div class="control-section">
                <h3>Edge Termination</h3>
                <div class="control-grid">
                    <div class="control-item">
                        <label>Termination Type</label>
                        <select id="termination-type">
                            <option value="none">No Termination</option>
                            <option value="bevel">Bevel Edge</option>
                            <option value="fjt">Field Junction Termination</option>
                            <option value="guard">Guard Rings</option>
                            <option value="jte">Junction Termination Extension</option>
                        </select>
                    </div>
                    <div class="control-item">
                        <label>Termination Length (μm)</label>
                        <input type="range" id="term-length" min="10" max="100" step="5" value="50">
                        <span class="value-display" id="term-length-value">50 μm</span>
                    </div>
                    <div class="control-item">
                        <label>Field Plate Length (μm)</label>
                        <input type="range" id="fp-length" min="0" max="20" step="1" value="5">
                        <span class="value-display" id="fp-length-value">5 μm</span>
                    </div>
                    <div class="control-item">
                        <label>Analysis Mode</label>
                        <select id="analysis-mode">
                            <option value="2d">2D Cross-Section</option>
                            <option value="1d">1D Vertical Profile</option>
                            <option value="corner">Corner Analysis</option>
                        </select>
                    </div>
                </div>
            </div>

            <button class="btn" onclick="updateFieldAnalysis()">
                <i class="fas fa-sync-alt"></i> Update Analysis
            </button>
        </div>

        <!-- 2D Field Distribution -->
        <div class="visualization-container">
            <h3 class="viz-title">2D Electric Field Distribution</h3>
            <div id="field-2d" style="height: 500px;"></div>
        </div>

        <!-- 1D Field Profile -->
        <div class="visualization-container">
            <h3 class="viz-title">Vertical Electric Field Profile</h3>
            <div id="field-1d" style="height: 400px;"></div>
        </div>

        <!-- Field Enhancement Analysis -->
        <div class="visualization-container">
            <h3 class="viz-title">Field Enhancement at Edges</h3>
            <div id="field-enhancement" style="height: 400px;"></div>
        </div>

        <!-- Breakdown Analysis -->
        <div class="visualization-container">
            <h3 class="viz-title">Breakdown Voltage vs Design Parameters</h3>
            <div id="breakdown-analysis" style="height: 400px;"></div>
        </div>

        <!-- Results Display -->
        <div class="visualization-container">
            <h3 class="viz-title">Field Analysis Results</h3>
            <div class="results-grid">
                <div class="result-card">
                    <div class="result-value" id="emax-value">2.8</div>
                    <div class="result-label">Peak Field (MV/cm)</div>
                </div>
                <div class="result-card">
                    <div class="result-value" id="vbr-value">1350</div>
                    <div class="result-label">Breakdown Voltage (V)</div>
                </div>
                <div class="result-card">
                    <div class="result-value" id="margin-value">69</div>
                    <div class="result-label">Safety Margin (%)</div>
                </div>
                <div class="result-card">
                    <div class="result-value" id="enhancement-value">1.2</div>
                    <div class="result-label">Edge Enhancement</div>
                </div>
            </div>
        </div>

        <!-- Physics Equations -->
        <div class="info-box">
            <h4>Electric Field Physics</h4>
            <div class="equation-box">
                <p>Poisson's Equation:</p>
                \[ \nabla \cdot \vec{E} = \frac{\rho}{\epsilon} = \frac{q(N_D - N_A)}{\epsilon} \]
            </div>
            <div class="equation-box">
                <p>Critical Field for GaN:</p>
                \[ E_c = 3.3 \times 10^6 \text{ V/cm} \]
            </div>
            <div class="equation-box">
                <p>Impact Ionization Rate:</p>
                \[ \alpha = a \exp\left(-\frac{b}{E}\right) \]
            </div>
        </div>

        <!-- Information Section -->
        <div class="info-box">
            <h4>Electric Field Management in Vertical GaN</h4>
            <p>
                Vertical GaN devices excel in electric field management due to their inherent structure. 
                The vertical drift region allows for uniform field distribution, avoiding the surface 
                field crowding issues common in lateral devices. Advanced edge termination techniques 
                further optimize the field profile, enabling operation closer to the theoretical limits.
            </p>
            <p style="margin-top: 1rem;">
                The simulator shows how different termination strategies affect field distribution and 
                breakdown voltage. Notice how proper edge termination can reduce peak fields by 30-40%, 
                significantly improving device reliability and allowing higher voltage operation.
            </p>
        </div>
    </div>

    <script>
        // Initialize range inputs
        document.querySelectorAll('input[type="range"]').forEach(input => {
            input.addEventListener('input', function() {
                const valueDisplay = document.getElementById(this.id + '-value');
                let value = this.value;
                
                switch(this.id) {
                    case 'voltage':
                        valueDisplay.textContent = value + ' V';
                        break;
                    case 'drift-thickness':
                    case 'term-length':
                    case 'fp-length':
                        valueDisplay.textContent = value + ' μm';
                        break;
                    case 'doping':
                        valueDisplay.textContent = `${Math.pow(10, parseFloat(value)).toExponential(1)}`;
                        break;
                    case 'temperature':
                        valueDisplay.textContent = value + ' °C';
                        break;
                }
            });
        });

        function updateFieldAnalysis() {
            const voltage = parseFloat(document.getElementById('voltage').value);
            const driftThickness = parseFloat(document.getElementById('drift-thickness').value);
            const doping = Math.pow(10, parseFloat(document.getElementById('doping').value));
            const temperature = parseFloat(document.getElementById('temperature').value);
            const terminationType = document.getElementById('termination-type').value;
            const termLength = parseFloat(document.getElementById('term-length').value);
            const fpLength = parseFloat(document.getElementById('fp-length').value);
            const analysisMode = document.getElementById('analysis-mode').value;

            // Update all visualizations
            plot2DFieldDistribution(voltage, driftThickness, terminationType, termLength);
            plot1DFieldProfile(voltage, driftThickness, doping);
            plotFieldEnhancement(terminationType, termLength, fpLength);
            plotBreakdownAnalysis(driftThickness, doping);
            
            // Update metrics
            updateFieldMetrics(voltage, driftThickness, doping, terminationType);
        }

        function plot2DFieldDistribution(voltage, thickness, termType, termLength) {
            // Generate 2D field data
            const nx = 100;
            const ny = 50;
            const x = [];
            const y = [];
            const field = [];
            
            const deviceWidth = thickness * 2;
            const deviceHeight = thickness;
            
            // Create grid
            for (let i = 0; i < nx; i++) {
                for (let j = 0; j < ny; j++) {
                    const xPos = (i / nx) * (deviceWidth + termLength) - termLength/2;
                    const yPos = (j / ny) * deviceHeight;
                    
                    x.push(xPos);
                    y.push(yPos);
                    
                    // Calculate field based on position
                    let E;
                    if (xPos >= 0 && xPos <= deviceWidth) {
                        // Inside device
                        E = voltage / thickness * (1 - yPos / deviceHeight) / 100; // MV/cm
                        
                        // Edge effects
                        if (xPos < 2 || xPos > deviceWidth - 2) {
                            E *= 1.5; // Edge enhancement
                        }
                    } else {
                        // Termination region
                        const termFactor = termType === 'none' ? 2.0 : 1.2;
                        E = voltage / thickness * Math.exp(-Math.abs(xPos - deviceWidth/2) / 10) * termFactor / 100;
                    }
                    
                    field.push(E);
                }
            }
            
            const data = [{
                type: 'contour',
                x: x,
                y: y,
                z: field,
                colorscale: 'Hot',
                reversescale: true,
                contours: {
                    start: 0,
                    end: 3.3,
                    size: 0.1
                },
                colorbar: {
                    title: 'E-Field (MV/cm)',
                    titleside: 'right'
                }
            }];
            
            const layout = {
                title: 'Electric Field Distribution (Cross-Section)',
                xaxis: { 
                    title: 'Lateral Position (μm)',
                    gridcolor: '#333'
                },
                yaxis: { 
                    title: 'Vertical Position (μm)',
                    gridcolor: '#333'
                },
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(20,20,20,0.8)',
                font: { color: '#e0e0e0' }
            };
            
            Plotly.newPlot('field-2d', data, layout, {responsive: true});
        }

        function plot1DFieldProfile(voltage, thickness, doping) {
            const positions = Array.from({length: 100}, (_, i) => i * thickness / 100);
            
            // Calculate field profile
            const q = 1.6e-19;
            const epsilon = 8.9 * 8.854e-14; // F/cm
            const Wdep = Math.sqrt(2 * epsilon * voltage / (q * doping));
            
            const field = positions.map(y => {
                if (y < Wdep * 1e4) {
                    // Depletion region
                    return voltage / thickness * (1 - y / thickness) / 100; // MV/cm
                } else {
                    // Neutral region
                    return 0;
                }
            });
            
            // Add comparison with lateral device
            const lateralField = positions.map(y => {
                const surfaceField = voltage / thickness / 100 * 1.8; // Higher surface field
                return surfaceField * Math.exp(-y / (thickness * 0.2));
            });
            
            const data = [
                {
                    x: positions,
                    y: field,
                    name: 'Vertical GaN',
                    type: 'scatter',
                    line: { color: '#3b82f6', width: 3 }
                },
                {
                    x: positions,
                    y: lateralField,
                    name: 'Lateral GaN (for comparison)',
                    type: 'scatter',
                    line: { color: '#60a5fa', width: 2, dash: 'dash' }
                }
            ];
            
            // Add critical field line
            data.push({
                x: [0, thickness],
                y: [3.3, 3.3],
                name: 'Critical Field',
                type: 'scatter',
                line: { color: '#ef4444', width: 2, dash: 'dot' },
                mode: 'lines'
            });
            
            const layout = {
                title: 'Vertical Electric Field Profile',
                xaxis: { 
                    title: 'Depth (μm)',
                    gridcolor: '#333'
                },
                yaxis: { 
                    title: 'Electric Field (MV/cm)',
                    gridcolor: '#333',
                    range: [0, 4]
                },
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(20,20,20,0.8)',
                font: { color: '#e0e0e0' },
                showlegend: true
            };
            
            Plotly.newPlot('field-1d', data, layout, {responsive: true});
        }

        function plotFieldEnhancement(termType, termLength, fpLength) {
            const angles = Array.from({length: 90}, (_, i) => i);
            
            // Field enhancement factors for different terminations
            const enhancements = {
                'none': angles.map(a => 1 + 1.5 * Math.sin(a * Math.PI / 180)),
                'bevel': angles.map(a => 1 + 0.3 * Math.sin(a * Math.PI / 180)),
                'fjt': angles.map(a => 1 + 0.25 * Math.sin(a * Math.PI / 180)),
                'guard': angles.map(a => 1 + 0.35 * Math.sin(a * Math.PI / 180)),
                'jte': angles.map(a => 1 + 0.2 * Math.sin(a * Math.PI / 180))
            };
            
            // Effect of field plate
            const fpEffect = angles.map(a => {
                const base = enhancements[termType][a];
                return base * (1 - fpLength / 50 * 0.3);
            });
            
            const data = [
                {
                    x: angles,
                    y: enhancements[termType],
                    name: 'Without Field Plate',
                    type: 'scatter',
                    line: { color: '#60a5fa', width: 3 }
                },
                {
                    x: angles,
                    y: fpEffect,
                    name: 'With Field Plate',
                    type: 'scatter',
                    line: { color: '#3b82f6', width: 3 }
                }
            ];
            
            const layout = {
                title: `Field Enhancement - ${termType.toUpperCase()} Termination`,
                xaxis: { 
                    title: 'Angle from Junction (degrees)',
                    gridcolor: '#333'
                },
                yaxis: { 
                    title: 'Field Enhancement Factor',
                    gridcolor: '#333'
                },
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(20,20,20,0.8)',
                font: { color: '#e0e0e0' }
            };
            
            Plotly.newPlot('field-enhancement', data, layout, {responsive: true});
        }

        function plotBreakdownAnalysis(thickness, doping) {
            // Generate breakdown voltage curves
            const thicknesses = Array.from({length: 20}, (_, i) => 5 + i);
            const dopings = [1e15, 5e15, 1e16, 5e16];
            
            const data = dopings.map((Nd, idx) => {
                const Vbr = thicknesses.map(t => {
                    const Ec = 3.3e6; // V/cm
                    const epsilon = 8.9 * 8.854e-14;
                    const q = 1.6e-19;
                    
                    // Punch-through design
                    return 0.5 * Ec * t * 1e-4; // Simple approximation
                });
                
                return {
                    x: thicknesses,
                    y: Vbr,
                    name: `Nd = ${Nd.toExponential(0)}`,
                    type: 'scatter',
                    line: { width: 2 }
                };
            });
            
            // Add current operating point
            data.push({
                x: [thickness],
                y: [0.5 * 3.3e6 * thickness * 1e-4],
                name: 'Current Design',
                type: 'scatter',
                mode: 'markers',
                marker: { size: 15, color: '#ef4444' }
            });
            
            const layout = {
                title: 'Breakdown Voltage vs Drift Layer Design',
                xaxis: { 
                    title: 'Drift Layer Thickness (μm)',
                    gridcolor: '#333'
                },
                yaxis: { 
                    title: 'Breakdown Voltage (V)',
                    gridcolor: '#333'
                },
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(20,20,20,0.8)',
                font: { color: '#e0e0e0' }
            };
            
            Plotly.newPlot('breakdown-analysis', data, layout, {responsive: true});
        }

        function updateFieldMetrics(voltage, thickness, doping, termType) {
            // Calculate peak field
            const basePeak = voltage / thickness / 100; // MV/cm
            const termFactors = {
                'none': 2.0,
                'bevel': 1.3,
                'fjt': 1.25,
                'guard': 1.35,
                'jte': 1.2
            };
            const Emax = basePeak * termFactors[termType];
            
            // Calculate breakdown voltage
            const Ec = 3.3; // MV/cm
            const Vbr = Ec / Emax * voltage;
            
            // Safety margin
            const margin = (Vbr - voltage) / voltage * 100;
            
            // Edge enhancement
            const enhancement = termFactors[termType];
            
            // Update display
            document.getElementById('emax-value').textContent = Emax.toFixed(2);
            document.getElementById('vbr-value').textContent = Math.round(Vbr);
            document.getElementById('margin-value').textContent = Math.round(margin);
            document.getElementById('enhancement-value').textContent = enhancement.toFixed(1);
        }

        // Initial analysis
        updateFieldAnalysis();
    </script>
</body>
</html>