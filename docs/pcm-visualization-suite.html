<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualization Suite - PCM Advanced Plotting</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a0a2a 100%);
            color: #e0e0e0;
            min-height: 100vh;
        }

        .header {
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            border-bottom: 1px solid rgba(147, 51, 234, 0.3);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .back-btn {
            background: linear-gradient(135deg, #9333ea, #7c3aed);
            color: white;
            padding: 0.5rem 1.5rem;
            border-radius: 8px;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
        }

        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .page-title {
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(135deg, #9333ea, #c084fc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
            margin-bottom: 3rem;
        }

        .viz-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 1px solid rgba(147, 51, 234, 0.2);
            flex-wrap: wrap;
        }

        .viz-tab {
            padding: 1rem 2rem;
            background: none;
            border: none;
            color: #a0a0a0;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .viz-tab.active {
            color: #c084fc;
        }

        .viz-tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(135deg, #9333ea, #c084fc);
        }

        .viz-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .viz-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .plot-container {
            background: rgba(20, 20, 20, 0.8);
            border: 1px solid rgba(147, 51, 234, 0.2);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .plot-title {
            font-size: 1.5rem;
            color: #c084fc;
            margin-bottom: 1.5rem;
        }

        .controls-panel {
            background: rgba(147, 51, 234, 0.1);
            border: 1px solid rgba(147, 51, 234, 0.3);
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .control-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .control-group {
            display: flex;
            flex-direction: column;
        }

        .control-label {
            color: #c084fc;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .control-input {
            padding: 0.5rem;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(147, 51, 234, 0.3);
            color: #e0e0e0;
            border-radius: 5px;
        }

        .btn {
            background: linear-gradient(135deg, #9333ea, #7c3aed);
            color: white;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(147, 51, 234, 0.4);
        }

        .export-options {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .export-btn {
            flex: 1;
            padding: 0.5rem;
            background: rgba(147, 51, 234, 0.2);
            border: 1px solid rgba(147, 51, 234, 0.5);
            color: #c084fc;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .export-btn:hover {
            background: rgba(147, 51, 234, 0.3);
        }

        .animation-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
            margin: 1rem 0;
        }

        .animation-btn {
            padding: 0.5rem 1rem;
            background: rgba(76, 237, 196, 0.2);
            border: 1px solid #4ecdc4;
            color: #4ecdc4;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .animation-btn:hover {
            background: rgba(76, 237, 196, 0.3);
        }

        .speed-control {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .canvas-3d {
            width: 100%;
            height: 500px;
            border-radius: 10px;
            background: rgba(0, 0, 0, 0.5);
        }

        .template-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .template-card {
            background: rgba(20, 20, 20, 0.8);
            border: 1px solid rgba(147, 51, 234, 0.2);
            border-radius: 10px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .template-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(147, 51, 234, 0.3);
        }

        .template-preview {
            height: 150px;
            background: linear-gradient(135deg, rgba(147, 51, 234, 0.2), rgba(196, 132, 252, 0.2));
            border-radius: 8px;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: #9333ea;
        }

        .template-name {
            color: #c084fc;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .template-description {
            color: #a0a0a0;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <h2 style="color: #c084fc;">Visualization Suite</h2>
            <a href="pcm-complete-project.html" class="back-btn">
                <i class="fas fa-arrow-left"></i> Back to PCM Suite
            </a>
        </div>
    </header>

    <main class="main-content">
        <h1 class="page-title">Advanced Visualization Tools</h1>
        
        <!-- Visualization Tabs -->
        <div class="viz-tabs">
            <button class="viz-tab active" onclick="switchViz('2d')">2D Plots</button>
            <button class="viz-tab" onclick="switchViz('3d')">3D Surfaces</button>
            <button class="viz-tab" onclick="switchViz('animation')">Animations</button>
            <button class="viz-tab" onclick="switchViz('heatmap')">Heatmaps</button>
            <button class="viz-tab" onclick="switchViz('contour')">Contour Plots</button>
            <button class="viz-tab" onclick="switchViz('templates')">Templates</button>
        </div>
        
        <!-- 2D Plots Section -->
        <div id="2d-section" class="viz-section active">
            <div class="plot-container">
                <h2 class="plot-title">
                    <i class="fas fa-chart-line"></i> Publication-Quality 2D Plots
                </h2>
                
                <div class="controls-panel">
                    <div class="control-row">
                        <div class="control-group">
                            <label class="control-label">Plot Type</label>
                            <select class="control-input" id="plot-type">
                                <option>Line Plot</option>
                                <option>Scatter Plot</option>
                                <option>Bar Chart</option>
                                <option>Error Bars</option>
                                <option>Multi-Axis</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label class="control-label">Color Scheme</label>
                            <select class="control-input">
                                <option>Viridis</option>
                                <option>Plasma</option>
                                <option>Custom PCM</option>
                                <option>Nature</option>
                                <option>Science</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label class="control-label">Font Size</label>
                            <input type="number" class="control-input" value="14" min="8" max="24">
                        </div>
                        <div class="control-group">
                            <label class="control-label">DPI</label>
                            <input type="number" class="control-input" value="300" min="72" max="600">
                        </div>
                    </div>
                    
                    <button class="btn" onclick="updatePlot()">
                        <i class="fas fa-sync"></i> Update Plot
                    </button>
                </div>
                
                <div id="plot-2d" style="height: 500px;"></div>
                
                <div class="export-options">
                    <div class="export-btn"><i class="fas fa-file-pdf"></i> Export PDF</div>
                    <div class="export-btn"><i class="fas fa-file-image"></i> Export PNG</div>
                    <div class="export-btn"><i class="fas fa-file-alt"></i> Export SVG</div>
                    <div class="export-btn"><i class="fas fa-code"></i> Export Code</div>
                </div>
            </div>
        </div>
        
        <!-- 3D Surfaces Section -->
        <div id="3d-section" class="viz-section">
            <div class="plot-container">
                <h2 class="plot-title">
                    <i class="fas fa-cube"></i> 3D Surface Visualization
                </h2>
                
                <div class="controls-panel">
                    <div class="control-row">
                        <div class="control-group">
                            <label class="control-label">Surface Type</label>
                            <select class="control-input">
                                <option>Mesh</option>
                                <option>Surface</option>
                                <option>Wireframe</option>
                                <option>Scatter3D</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label class="control-label">Colormap</label>
                            <select class="control-input">
                                <option>Jet</option>
                                <option>Hot</option>
                                <option>Cool</option>
                                <option>Rainbow</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label class="control-label">Resolution</label>
                            <input type="range" class="control-input" min="10" max="100" value="50">
                        </div>
                        <div class="control-group">
                            <label class="control-label">Opacity</label>
                            <input type="range" class="control-input" min="0" max="100" value="100">
                        </div>
                    </div>
                </div>
                
                <div id="plot-3d" style="height: 500px;"></div>
            </div>
        </div>
        
        <!-- Animation Section -->
        <div id="animation-section" class="viz-section">
            <div class="plot-container">
                <h2 class="plot-title">
                    <i class="fas fa-film"></i> Animated Phase Evolution
                </h2>
                
                <div class="animation-controls">
                    <button class="animation-btn" onclick="playAnimation()">
                        <i class="fas fa-play"></i> Play
                    </button>
                    <button class="animation-btn" onclick="pauseAnimation()">
                        <i class="fas fa-pause"></i> Pause
                    </button>
                    <button class="animation-btn" onclick="resetAnimation()">
                        <i class="fas fa-redo"></i> Reset
                    </button>
                    
                    <div class="speed-control">
                        <label style="color: #c084fc;">Speed:</label>
                        <input type="range" min="1" max="10" value="5" style="width: 100px;">
                    </div>
                    
                    <div class="speed-control">
                        <label style="color: #c084fc;">Frame:</label>
                        <span id="frame-counter">0 / 100</span>
                    </div>
                </div>
                
                <div id="animation-plot" style="height: 500px;"></div>
                
                <div class="export-options" style="margin-top: 2rem;">
                    <div class="export-btn"><i class="fas fa-video"></i> Export MP4</div>
                    <div class="export-btn"><i class="fas fa-file-image"></i> Export GIF</div>
                    <div class="export-btn"><i class="fas fa-images"></i> Export Frames</div>
                </div>
            </div>
        </div>
        
        <!-- Heatmap Section -->
        <div id="heatmap-section" class="viz-section">
            <div class="plot-container">
                <h2 class="plot-title">
                    <i class="fas fa-th"></i> Heatmap Visualization
                </h2>
                
                <div id="heatmap-plot" style="height: 500px;"></div>
            </div>
        </div>
        
        <!-- Contour Section -->
        <div id="contour-section" class="viz-section">
            <div class="plot-container">
                <h2 class="plot-title">
                    <i class="fas fa-map"></i> Contour Analysis
                </h2>
                
                <div id="contour-plot" style="height: 500px;"></div>
            </div>
        </div>
        
        <!-- Templates Section -->
        <div id="templates-section" class="viz-section">
            <div class="plot-container">
                <h2 class="plot-title">
                    <i class="fas fa-palette"></i> Visualization Templates
                </h2>
                
                <div class="template-gallery">
                    <div class="template-card" onclick="loadTemplate('nature')">
                        <div class="template-preview">
                            <i class="fas fa-leaf"></i>
                        </div>
                        <div class="template-name">Nature Style</div>
                        <div class="template-description">
                            Publication-ready format following Nature journal guidelines
                        </div>
                    </div>
                    
                    <div class="template-card" onclick="loadTemplate('science')">
                        <div class="template-preview">
                            <i class="fas fa-atom"></i>
                        </div>
                        <div class="template-name">Science Style</div>
                        <div class="template-description">
                            Format optimized for Science magazine submissions
                        </div>
                    </div>
                    
                    <div class="template-card" onclick="loadTemplate('ieee')">
                        <div class="template-preview">
                            <i class="fas fa-microchip"></i>
                        </div>
                        <div class="template-name">IEEE Format</div>
                        <div class="template-description">
                            IEEE conference and journal paper format
                        </div>
                    </div>
                    
                    <div class="template-card" onclick="loadTemplate('presentation')">
                        <div class="template-preview">
                            <i class="fas fa-presentation"></i>
                        </div>
                        <div class="template-name">Presentation</div>
                        <div class="template-description">
                            High-contrast plots for presentations
                        </div>
                    </div>
                    
                    <div class="template-card" onclick="loadTemplate('poster')">
                        <div class="template-preview">
                            <i class="fas fa-image"></i>
                        </div>
                        <div class="template-name">Poster Format</div>
                        <div class="template-description">
                            Large-format plots for academic posters
                        </div>
                    </div>
                    
                    <div class="template-card" onclick="loadTemplate('web')">
                        <div class="template-preview">
                            <i class="fas fa-globe"></i>
                        </div>
                        <div class="template-name">Web Interactive</div>
                        <div class="template-description">
                            Interactive plots for web deployment
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Switch visualization tabs
        function switchViz(type) {
            // Hide all sections
            document.querySelectorAll('.viz-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active from all tabs
            document.querySelectorAll('.viz-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(type + '-section').classList.add('active');
            event.target.classList.add('active');
            
            // Initialize the appropriate plot
            if (type === '2d') init2DPlot();
            else if (type === '3d') init3DPlot();
            else if (type === 'animation') initAnimation();
            else if (type === 'heatmap') initHeatmap();
            else if (type === 'contour') initContour();
        }
        
        // Initialize 2D plot
        function init2DPlot() {
            const x = [];
            const y1 = [];
            const y2 = [];
            
            for (let i = 0; i < 100; i++) {
                x.push(i);
                y1.push(Math.sin(i * 0.1) * Math.exp(-i * 0.01));
                y2.push(Math.cos(i * 0.1) * Math.exp(-i * 0.01));
            }
            
            const trace1 = {
                x: x,
                y: y1,
                type: 'scatter',
                mode: 'lines',
                name: 'Crystalline Phase',
                line: { color: '#9333ea', width: 3 }
            };
            
            const trace2 = {
                x: x,
                y: y2,
                type: 'scatter',
                mode: 'lines',
                name: 'Amorphous Phase',
                line: { color: '#4ecdc4', width: 3 }
            };
            
            const layout = {
                title: 'Phase Evolution Dynamics',
                xaxis: { title: 'Time (ns)', gridcolor: '#333' },
                yaxis: { title: 'Phase Fraction', gridcolor: '#333' },
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#e0e0e0', size: 14 }
            };
            
            Plotly.newPlot('plot-2d', [trace1, trace2], layout, {responsive: true});
        }
        
        // Initialize 3D plot
        function init3DPlot() {
            const size = 50;
            const x = [];
            const y = [];
            const z = [];
            
            for (let i = 0; i < size; i++) {
                x[i] = [];
                y[i] = [];
                z[i] = [];
                for (let j = 0; j < size; j++) {
                    x[i].push(i);
                    y[i].push(j);
                    z[i].push(Math.sin(i * 0.2) * Math.cos(j * 0.2) * Math.exp(-(i*i + j*j) * 0.001));
                }
            }
            
            const data = [{
                z: z,
                type: 'surface',
                colorscale: 'Viridis'
            }];
            
            const layout = {
                title: '3D Temperature Distribution',
                scene: {
                    xaxis: { title: 'X Position (nm)' },
                    yaxis: { title: 'Y Position (nm)' },
                    zaxis: { title: 'Temperature (K)' }
                },
                paper_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#e0e0e0' }
            };
            
            Plotly.newPlot('plot-3d', data, layout, {responsive: true});
        }
        
        // Initialize animation
        function initAnimation() {
            const frames = [];
            const steps = [];
            
            for (let frame = 0; frame < 50; frame++) {
                const x = [];
                const y = [];
                
                for (let i = 0; i < 100; i++) {
                    x.push(i);
                    y.push(Math.sin(i * 0.1 - frame * 0.1) * Math.exp(-i * 0.01));
                }
                
                frames.push({
                    data: [{x: x, y: y}],
                    name: frame
                });
                
                steps.push({
                    args: [[frame], {frame: {duration: 50, redraw: true}}],
                    label: frame,
                    method: 'animate'
                });
            }
            
            const trace = {
                x: frames[0].data[0].x,
                y: frames[0].data[0].y,
                type: 'scatter',
                mode: 'lines',
                line: { color: '#9333ea', width: 3 }
            };
            
            const layout = {
                title: 'Crystallization Animation',
                xaxis: { title: 'Position (nm)', gridcolor: '#333' },
                yaxis: { title: 'Crystalline Fraction', gridcolor: '#333' },
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#e0e0e0' },
                updatemenus: [{
                    type: 'buttons',
                    showactive: false,
                    buttons: [{
                        label: 'Play',
                        method: 'animate',
                        args: [null, {frame: {duration: 50}, fromcurrent: true}]
                    }]
                }]
            };
            
            Plotly.newPlot('animation-plot', [trace], layout, {responsive: true});
            Plotly.addFrames('animation-plot', frames);
        }
        
        // Initialize heatmap
        function initHeatmap() {
            const size = 30;
            const z = [];
            
            for (let i = 0; i < size; i++) {
                z[i] = [];
                for (let j = 0; j < size; j++) {
                    z[i].push(Math.random() * 100);
                }
            }
            
            const data = [{
                z: z,
                type: 'heatmap',
                colorscale: 'Hot'
            }];
            
            const layout = {
                title: 'Array Thermal Crosstalk Heatmap',
                xaxis: { title: 'Column Index' },
                yaxis: { title: 'Row Index' },
                paper_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#e0e0e0' }
            };
            
            Plotly.newPlot('heatmap-plot', data, layout, {responsive: true});
        }
        
        // Initialize contour
        function initContour() {
            const size = 50;
            const z = [];
            
            for (let i = 0; i < size; i++) {
                z[i] = [];
                for (let j = 0; j < size; j++) {
                    z[i].push(Math.sin(i * 0.1) * Math.cos(j * 0.1));
                }
            }
            
            const data = [{
                z: z,
                type: 'contour',
                colorscale: 'Viridis',
                contours: {
                    coloring: 'heatmap'
                }
            }];
            
            const layout = {
                title: 'Electric Field Contours',
                xaxis: { title: 'X Position (nm)' },
                yaxis: { title: 'Y Position (nm)' },
                paper_bgcolor: 'rgba(0,0,0,0)',
                font: { color: '#e0e0e0' }
            };
            
            Plotly.newPlot('contour-plot', data, layout, {responsive: true});
        }
        
        // Update plot
        function updatePlot() {
            const plotType = document.getElementById('plot-type').value;
            console.log('Updating plot type:', plotType);
            init2DPlot(); // Re-initialize with new settings
        }
        
        // Animation controls
        function playAnimation() {
            Plotly.animate('animation-plot', null, {
                frame: {duration: 50},
                fromcurrent: true
            });
        }
        
        function pauseAnimation() {
            Plotly.animate('animation-plot', [], {mode: 'immediate'});
        }
        
        function resetAnimation() {
            Plotly.animate('animation-plot', [0]);
        }
        
        // Load template
        function loadTemplate(template) {
            console.log('Loading template:', template);
            alert(`Loading ${template} template...`);
        }
        
        // Initialize on load
        window.addEventListener('load', () => {
            init2DPlot();
        });
    </script>
</body>
</html>