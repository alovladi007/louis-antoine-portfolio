<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SST Architecture - 3-Stage Topology Design & Analysis</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #00d4ff;
            --secondary: #0099cc;
            --accent: #00ff88;
            --danger: #ff3366;
            --warning: #ffaa00;
            --dark: #0a0f1c;
            --light: #f0f4f8;
            --sic: #9966ff;
            --gan: #00ff99;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0a0f1c 0%, #1a2332 50%, #0a0f1c 100%);
            color: var(--light);
            min-height: 100vh;
        }

        .header {
            background: rgba(10, 15, 28, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 2px solid var(--primary);
            padding: 1.5rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-container {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--primary);
            text-decoration: none;
            padding: 0.5rem 1rem;
            border: 1px solid var(--primary);
            border-radius: 0.5rem;
            transition: all 0.3s;
        }

        .back-link:hover {
            background: rgba(0, 212, 255, 0.1);
        }

        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 3rem 2rem;
        }

        .page-title {
            font-size: 3rem;
            margin-bottom: 2rem;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
        }

        .section {
            background: rgba(26, 35, 50, 0.8);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 1rem;
            padding: 2.5rem;
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 1.8rem;
            color: var(--primary);
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .subsection {
            margin: 2rem 0;
        }

        .subsection-title {
            font-size: 1.3rem;
            color: var(--accent);
            margin-bottom: 1rem;
        }

        .topology-diagram {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--primary);
            border-radius: 0.5rem;
            padding: 2rem;
            margin: 2rem 0;
        }

        .stage-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .stage-card {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 0.5rem;
            padding: 1.5rem;
        }

        .parameter-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        .parameter-table th,
        .parameter-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid rgba(0, 212, 255, 0.2);
        }

        .parameter-table th {
            background: rgba(0, 212, 255, 0.1);
            color: var(--primary);
        }

        .equation {
            background: rgba(0, 0, 0, 0.5);
            border-left: 3px solid var(--accent);
            padding: 1rem;
            margin: 1rem 0;
            overflow-x: auto;
        }

        .control-panel {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--accent);
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin: 2rem 0;
        }

        .slider-group {
            margin: 1.5rem 0;
        }

        .slider-label {
            display: block;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .slider {
            width: 100%;
            height: 40px;
            -webkit-appearance: none;
            appearance: none;
            background: rgba(0, 212, 255, 0.1);
            border-radius: 20px;
            outline: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: var(--primary);
            border-radius: 50%;
            cursor: pointer;
        }

        .value-display {
            text-align: center;
            color: var(--accent);
            font-size: 1.2rem;
            font-weight: bold;
            margin-top: 0.5rem;
        }

        .chart-container {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 0.5rem;
            padding: 1rem;
            margin: 2rem 0;
            height: 400px;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        .result-card {
            background: rgba(0, 212, 255, 0.1);
            border: 1px solid var(--primary);
            border-radius: 0.5rem;
            padding: 1rem;
            text-align: center;
        }

        .result-value {
            font-size: 1.8rem;
            color: var(--accent);
            font-weight: bold;
        }

        .result-label {
            color: #94a3b8;
            margin-top: 0.5rem;
        }

        code {
            background: rgba(0, 212, 255, 0.1);
            padding: 0.2rem 0.4rem;
            border-radius: 0.25rem;
            font-family: 'Courier New', monospace;
            color: var(--primary);
        }

        .warning-box {
            background: rgba(255, 170, 0, 0.1);
            border: 1px solid var(--warning);
            border-radius: 0.5rem;
            padding: 1rem;
            margin: 1rem 0;
        }

        .info-box {
            background: rgba(0, 212, 255, 0.1);
            border: 1px solid var(--primary);
            border-radius: 0.5rem;
            padding: 1rem;
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="nav-container">
            <a href="sst-platform.html" class="back-link">
                <i class="fas fa-arrow-left"></i> Back to Platform
            </a>
            <div style="display: flex; gap: 2rem;">
                <a href="sst-dab-designer.html" style="color: var(--light); text-decoration: none;">DAB Designer</a>
                <a href="sst-mft-calculator.html" style="color: var(--light); text-decoration: none;">MFT Calculator</a>
                <a href="sst-zvs-analyzer.html" style="color: var(--light); text-decoration: none;">ZVS Analyzer</a>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <h1 class="page-title">3-Stage SST Architecture</h1>

        <!-- Overview Section -->
        <section class="section">
            <h2 class="section-title">
                <i class="fas fa-project-diagram"></i>
                System Overview
            </h2>
            <p style="line-height: 1.8; margin-bottom: 1.5rem;">
                The proposed solid-state transformer architecture employs a modular 3-stage topology designed for 
                bidirectional power flow, high efficiency, and grid service capability. Each stage is optimized 
                for specific voltage levels and functionality, leveraging wide-bandgap semiconductors to achieve 
                high power density and efficiency.
            </p>

            <div class="topology-diagram">
                <div id="topologyDiagram" style="height: 350px;"></div>
            </div>

            <div class="info-box">
                <strong>Key Design Principles:</strong>
                <ul style="margin-top: 0.5rem; padding-left: 1.5rem;">
                    <li>Modular architecture for scalability and redundancy</li>
                    <li>Galvanic isolation via medium-frequency transformer</li>
                    <li>Wide-bandgap devices for high-frequency operation</li>
                    <li>Integrated fault tolerance and protection</li>
                </ul>
            </div>
        </section>

        <!-- Stage 1: NPC Rectifier -->
        <section class="section">
            <h2 class="section-title">
                <i class="fas fa-exchange-alt"></i>
                Stage 1: Three-Level NPC Rectifier
            </h2>

            <div class="subsection">
                <h3 class="subsection-title">Topology Analysis</h3>
                <p style="line-height: 1.8;">
                    The neutral-point-clamped (NPC) rectifier provides AC-DC conversion with reduced voltage stress 
                    on semiconductors, lower harmonic distortion, and improved efficiency compared to two-level topologies. 
                    The three-level structure enables direct connection to medium voltage grids without series connection 
                    of devices.
                </p>

                <div class="equation">
                    <strong>DC Link Voltage:</strong><br>
                    \[ V_{dc} = \sqrt{2} \cdot V_{LL} \cdot m_a \]
                    where \( m_a \) is the modulation index (typically 0.9-0.95)
                </div>
            </div>

            <div class="subsection">
                <h3 class="subsection-title">Component Selection</h3>
                <table class="parameter-table">
                    <thead>
                        <tr>
                            <th>Component</th>
                            <th>Specification</th>
                            <th>Selected Device</th>
                            <th>Rationale</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Main Switches</td>
                            <td>3.3 kV, 450 A</td>
                            <td>Wolfspeed CAB450M12XM3</td>
                            <td>Low Rds_on, high temp operation</td>
                        </tr>
                        <tr>
                            <td>Clamping Diodes</td>
                            <td>3.3 kV, 300 A</td>
                            <td>SiC Schottky Diodes</td>
                            <td>Zero reverse recovery</td>
                        </tr>
                        <tr>
                            <td>DC Link Capacitor</td>
                            <td>20 kV, 5 mF</td>
                            <td>Film Capacitor Bank</td>
                            <td>Low ESR, high ripple current</td>
                        </tr>
                        <tr>
                            <td>Input Filter</td>
                            <td>LCL Configuration</td>
                            <td>L1=2mH, C=50μF, L2=1mH</td>
                            <td>THD < 3%, resonance damping</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="control-panel">
                <h3 class="subsection-title">Interactive Design Tool</h3>
                <div class="slider-group">
                    <label class="slider-label">Input Voltage (kV RMS)</label>
                    <input type="range" class="slider" id="inputVoltage" min="4" max="15" value="13.8" step="0.1">
                    <div class="value-display" id="inputVoltageValue">13.8 kV</div>
                </div>
                <div class="slider-group">
                    <label class="slider-label">Switching Frequency (kHz)</label>
                    <input type="range" class="slider" id="switchingFreq" min="2" max="10" value="5" step="0.5">
                    <div class="value-display" id="switchingFreqValue">5.0 kHz</div>
                </div>
                <div class="results-grid">
                    <div class="result-card">
                        <div class="result-value" id="dcVoltage">19.5</div>
                        <div class="result-label">DC Link (kV)</div>
                    </div>
                    <div class="result-card">
                        <div class="result-value" id="thd">2.8</div>
                        <div class="result-label">THD (%)</div>
                    </div>
                    <div class="result-card">
                        <div class="result-value" id="efficiency">98.2</div>
                        <div class="result-label">Efficiency (%)</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Stage 2: DAB -->
        <section class="section">
            <h2 class="section-title">
                <i class="fas fa-sync"></i>
                Stage 2: Dual Active Bridge with MF Transformer
            </h2>

            <div class="subsection">
                <h3 class="subsection-title">DAB Operation Principle</h3>
                <p style="line-height: 1.8;">
                    The dual active bridge provides bidirectional power transfer with galvanic isolation through a 
                    medium-frequency transformer. Power flow is controlled via phase-shift modulation between primary 
                    and secondary bridges, enabling soft-switching operation across a wide load range.
                </p>

                <div class="equation">
                    <strong>Power Transfer Equation:</strong><br>
                    \[ P = \frac{n \cdot V_1 \cdot V_2}{2\pi f_s L_{lk}} \cdot \phi \left(1 - \frac{|\phi|}{\pi}\right) \]
                    where \( \phi \) is the phase shift, \( L_{lk} \) is leakage inductance
                </div>
            </div>

            <div class="subsection">
                <h3 class="subsection-title">MF Transformer Design</h3>
                <div class="stage-details">
                    <div class="stage-card">
                        <h4 style="color: var(--primary); margin-bottom: 1rem;">Core Selection</h4>
                        <ul style="list-style: none; padding: 0;">
                            <li>• Material: Nanocrystalline (Vitroperm 500F)</li>
                            <li>• Core Type: C-Core Configuration</li>
                            <li>• Effective Area: 45 cm²</li>
                            <li>• Window Area: 120 cm²</li>
                            <li>• Operating Flux: 0.8 T @ 50 kHz</li>
                        </ul>
                    </div>
                    <div class="stage-card">
                        <h4 style="color: var(--primary); margin-bottom: 1rem;">Winding Design</h4>
                        <ul style="list-style: none; padding: 0;">
                            <li>• Primary: 28 turns, Litz wire 1000×0.2mm</li>
                            <li>• Secondary: 3 turns, copper foil 0.5mm</li>
                            <li>• Turns Ratio: 9.33:1</li>
                            <li>• Leakage Inductance: 25 μH (designed)</li>
                            <li>• Insulation: Nomex, 50 kV BIL</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="chart-container">
                <div id="dabWaveforms" style="height: 100%;"></div>
            </div>
        </section>

        <!-- Stage 3: Output Converter -->
        <section class="section">
            <h2 class="section-title">
                <i class="fas fa-battery-full"></i>
                Stage 3: LV Output Converter
            </h2>

            <div class="subsection">
                <h3 class="subsection-title">Configuration Options</h3>
                <div class="stage-details">
                    <div class="stage-card">
                        <h4 style="color: var(--accent); margin-bottom: 1rem;">DC Output (DCFC Mode)</h4>
                        <p style="margin-bottom: 1rem;">Regulated DC bus for EV fast charging</p>
                        <ul style="list-style: none; padding: 0;">
                            <li>• Output: 400-1000 VDC adjustable</li>
                            <li>• Current: up to 500 A</li>
                            <li>• Ripple: < 1% peak-to-peak</li>
                            <li>• Protocol: CCS/ChaoJi compatible</li>
                        </ul>
                    </div>
                    <div class="stage-card">
                        <h4 style="color: var(--accent); margin-bottom: 1rem;">AC Output (Grid-Tie Mode)</h4>
                        <p style="margin-bottom: 1rem;">Three-phase inverter for grid connection</p>
                        <ul style="list-style: none; padding: 0;">
                            <li>• Output: 480 VAC, 3-phase</li>
                            <li>• THD: < 3% at rated load</li>
                            <li>• Power Factor: 0.8 leading to lagging</li>
                            <li>• Grid Services: Volt-VAR, frequency support</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="subsection">
                <h3 class="subsection-title">GaN Device Implementation</h3>
                <p style="line-height: 1.8; margin-bottom: 1rem;">
                    The LV stage utilizes GaN HEMTs for high-frequency operation with minimal switching losses. 
                    The enhanced electron mobility and low gate charge enable switching frequencies up to 200 kHz, 
                    reducing passive component size and improving dynamic response.
                </p>
                <table class="parameter-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>GaN HEMT</th>
                            <th>Si MOSFET</th>
                            <th>Improvement</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Switching Frequency</td>
                            <td>200 kHz</td>
                            <td>50 kHz</td>
                            <td>4×</td>
                        </tr>
                        <tr>
                            <td>Switching Loss</td>
                            <td>0.2 mJ</td>
                            <td>0.8 mJ</td>
                            <td>75% reduction</td>
                        </tr>
                        <tr>
                            <td>Power Density</td>
                            <td>8 kW/L</td>
                            <td>3 kW/L</td>
                            <td>2.7×</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- System Integration -->
        <section class="section">
            <h2 class="section-title">
                <i class="fas fa-cogs"></i>
                System Integration & Control
            </h2>

            <div class="subsection">
                <h3 class="subsection-title">Hierarchical Control Architecture</h3>
                <div class="info-box">
                    <strong>Level 1 - Device Control (FPGA):</strong> PWM generation, dead-time insertion, protection
                    <br><br>
                    <strong>Level 2 - Converter Control (DSP):</strong> Current/voltage loops, phase-shift control, MPPT
                    <br><br>
                    <strong>Level 3 - System Control (ARM):</strong> Power management, grid services, communication
                </div>
            </div>

            <div class="subsection">
                <h3 class="subsection-title">Protection & Fault Management</h3>
                <div class="warning-box">
                    <strong><i class="fas fa-exclamation-triangle"></i> Critical Protection Features:</strong>
                    <ul style="margin-top: 0.5rem; padding-left: 1.5rem;">
                        <li>Overcurrent protection with di/dt detection</li>
                        <li>Overvoltage clamping and crowbar circuits</li>
                        <li>Thermal monitoring with predictive derating</li>
                        <li>Ground fault detection and isolation</li>
                        <li>Arc flash mitigation systems</li>
                    </ul>
                </div>
            </div>

            <div class="chart-container">
                <div id="efficiencyMap" style="height: 100%;"></div>
            </div>
        </section>

        <!-- Experimental Results -->
        <section class="section">
            <h2 class="section-title">
                <i class="fas fa-chart-line"></i>
                Experimental Validation
            </h2>

            <div class="subsection">
                <h3 class="subsection-title">Prototype Specifications</h3>
                <table class="parameter-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Design Target</th>
                            <th>Measured Value</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Power Rating</td>
                            <td>350 kW</td>
                            <td>352 kW</td>
                            <td style="color: var(--accent);">✓ Achieved</td>
                        </tr>
                        <tr>
                            <td>Peak Efficiency</td>
                            <td>98.5%</td>
                            <td>98.3%</td>
                            <td style="color: var(--accent);">✓ Close</td>
                        </tr>
                        <tr>
                            <td>Power Density</td>
                            <td>5 kW/L</td>
                            <td>4.8 kW/L</td>
                            <td style="color: var(--warning);">○ Optimizing</td>
                        </tr>
                        <tr>
                            <td>Input THD</td>
                            <td>< 3%</td>
                            <td>2.4%</td>
                            <td style="color: var(--accent);">✓ Achieved</td>
                        </tr>
                        <tr>
                            <td>ZVS Range</td>
                            <td>20-100%</td>
                            <td>25-100%</td>
                            <td style="color: var(--accent);">✓ Achieved</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="chart-container">
                <div id="testResults" style="height: 100%;"></div>
            </div>
        </section>
    </main>

    <script>
        // Topology Diagram
        const topologyTrace = {
            x: ['MV Grid', '', 'NPC Rectifier', '', 'DC Link', '', 'DAB + MFT', '', 'LV DC/AC', '', 'Load'],
            y: [13.8, 13.8, 13.8, 19.5, 19.5, 19.5, 19.5, 0.8, 0.8, 0.8, 0.8],
            mode: 'lines+markers',
            type: 'scatter',
            line: {
                color: '#00d4ff',
                width: 3,
                shape: 'hv'
            },
            marker: {
                size: 12,
                color: ['#ffaa00', '', '#9966ff', '', '#00d4ff', '', '#00ff88', '', '#00ff99', '', '#ff3366']
            }
        };

        const topologyLayout = {
            title: '3-Stage Power Flow',
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0.3)',
            font: { color: '#94a3b8' },
            xaxis: {
                title: 'Conversion Stage',
                gridcolor: 'rgba(0, 212, 255, 0.1)'
            },
            yaxis: {
                title: 'Voltage Level (kV)',
                gridcolor: 'rgba(0, 212, 255, 0.1)',
                type: 'log'
            },
            showlegend: false
        };

        Plotly.newPlot('topologyDiagram', [topologyTrace], topologyLayout, {displayModeBar: false});

        // DAB Waveforms
        const time = [];
        const primaryVoltage = [];
        const secondaryVoltage = [];
        const current = [];

        for (let i = 0; i < 1000; i++) {
            const t = i / 1000 * 4 * Math.PI;
            time.push(t);
            primaryVoltage.push(Math.sign(Math.sin(t)) * 19.5);
            secondaryVoltage.push(Math.sign(Math.sin(t - Math.PI/6)) * 0.8);
            current.push(5 * Math.sin(t - Math.PI/12));
        }

        const dabTraces = [
            {
                x: time,
                y: primaryVoltage,
                name: 'Primary Voltage',
                line: { color: '#9966ff' }
            },
            {
                x: time,
                y: secondaryVoltage,
                name: 'Secondary Voltage',
                yaxis: 'y2',
                line: { color: '#00ff99' }
            },
            {
                x: time,
                y: current,
                name: 'Transformer Current',
                yaxis: 'y3',
                line: { color: '#ffaa00' }
            }
        ];

        const dabLayout = {
            title: 'DAB Operating Waveforms (φ = 30°)',
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0.3)',
            font: { color: '#94a3b8' },
            xaxis: {
                title: 'Time (μs)',
                gridcolor: 'rgba(0, 212, 255, 0.1)'
            },
            yaxis: {
                title: 'Primary (kV)',
                titlefont: {color: '#9966ff'},
                tickfont: {color: '#9966ff'},
                gridcolor: 'rgba(153, 102, 255, 0.1)'
            },
            yaxis2: {
                title: 'Secondary (kV)',
                titlefont: {color: '#00ff99'},
                tickfont: {color: '#00ff99'},
                overlaying: 'y',
                side: 'right'
            },
            yaxis3: {
                title: 'Current (kA)',
                titlefont: {color: '#ffaa00'},
                tickfont: {color: '#ffaa00'},
                overlaying: 'y',
                side: 'left',
                position: 0.15
            },
            showlegend: true,
            legend: {
                x: 0.7,
                y: 1
            }
        };

        Plotly.newPlot('dabWaveforms', dabTraces, dabLayout, {displayModeBar: false});

        // Efficiency Map
        const power = [];
        const voltage = [];
        const efficiency = [];

        for (let i = 0; i < 50; i++) {
            power.push(i * 7);
            const row = [];
            for (let j = 0; j < 50; j++) {
                if (i === 0) voltage.push(400 + j * 12);
                const eff = 98.5 - Math.abs(i - 25) * 0.1 - Math.abs(j - 25) * 0.05 + Math.random() * 0.2;
                row.push(Math.min(98.5, Math.max(95, eff)));
            }
            efficiency.push(row);
        }

        const efficiencyData = [{
            z: efficiency,
            x: power,
            y: voltage,
            type: 'heatmap',
            colorscale: [
                [0, '#ff3366'],
                [0.5, '#ffaa00'],
                [1, '#00ff88']
            ],
            colorbar: {
                title: 'Efficiency (%)',
                titleside: 'right'
            }
        }];

        const efficiencyLayout = {
            title: 'System Efficiency Map',
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0.3)',
            font: { color: '#94a3b8' },
            xaxis: {
                title: 'Output Power (kW)',
                gridcolor: 'rgba(0, 212, 255, 0.1)'
            },
            yaxis: {
                title: 'Output Voltage (V)',
                gridcolor: 'rgba(0, 212, 255, 0.1)'
            }
        };

        Plotly.newPlot('efficiencyMap', efficiencyData, efficiencyLayout, {displayModeBar: false});

        // Test Results
        const testTime = ['0h', '2h', '4h', '6h', '8h', '10h', '12h'];
        const temperature = [25, 45, 58, 65, 68, 70, 71];
        const efficiencyTime = [98.3, 98.2, 98.0, 97.8, 97.7, 97.6, 97.6];

        const testTraces = [
            {
                x: testTime,
                y: temperature,
                name: 'Junction Temperature',
                type: 'scatter',
                mode: 'lines+markers',
                line: { color: '#ff3366' },
                marker: { size: 8 }
            },
            {
                x: testTime,
                y: efficiencyTime,
                name: 'Efficiency',
                type: 'scatter',
                mode: 'lines+markers',
                yaxis: 'y2',
                line: { color: '#00ff88' },
                marker: { size: 8 }
            }
        ];

        const testLayout = {
            title: 'Thermal Cycling Test Results',
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0.3)',
            font: { color: '#94a3b8' },
            xaxis: {
                title: 'Test Duration',
                gridcolor: 'rgba(0, 212, 255, 0.1)'
            },
            yaxis: {
                title: 'Temperature (°C)',
                titlefont: {color: '#ff3366'},
                tickfont: {color: '#ff3366'},
                gridcolor: 'rgba(255, 51, 102, 0.1)'
            },
            yaxis2: {
                title: 'Efficiency (%)',
                titlefont: {color: '#00ff88'},
                tickfont: {color: '#00ff88'},
                overlaying: 'y',
                side: 'right',
                range: [95, 99]
            },
            showlegend: true
        };

        Plotly.newPlot('testResults', testTraces, testLayout, {displayModeBar: false});

        // Interactive Controls
        document.getElementById('inputVoltage').addEventListener('input', function(e) {
            const value = parseFloat(e.target.value);
            document.getElementById('inputVoltageValue').textContent = value.toFixed(1) + ' kV';
            updateCalculations();
        });

        document.getElementById('switchingFreq').addEventListener('input', function(e) {
            const value = parseFloat(e.target.value);
            document.getElementById('switchingFreqValue').textContent = value.toFixed(1) + ' kHz';
            updateCalculations();
        });

        function updateCalculations() {
            const vin = parseFloat(document.getElementById('inputVoltage').value);
            const fs = parseFloat(document.getElementById('switchingFreq').value);
            
            // Calculate DC voltage
            const vdc = Math.sqrt(2) * vin * 0.95;
            document.getElementById('dcVoltage').textContent = vdc.toFixed(1);
            
            // Calculate THD (simplified model)
            const thd = 5.0 / Math.sqrt(fs);
            document.getElementById('thd').textContent = thd.toFixed(1);
            
            // Calculate efficiency (simplified model)
            const eff = 98.5 - (10 - fs) * 0.05;
            document.getElementById('efficiency').textContent = eff.toFixed(1);
        }
    </script>
</body>
</html>