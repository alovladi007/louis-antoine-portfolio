<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mmWave RF Frontend Design - 28GHz 5G System</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <a href="index.html" class="logo">LA</a>
            </div>
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link">Home</a></li>
                <li><a href="index.html#projects" class="nav-link">Projects</a></li>
                <li><a href="additional-projects.html" class="nav-link">All Projects</a></li>
            </ul>
        </div>
    </nav>

    <section class="project-detail">
        <div class="container">
            <div class="back-link">
                <a href="additional-projects.html"><i class="fas fa-arrow-left"></i> Back to Projects</a>
            </div>
            
            <div class="project-header">
                <h1>mmWave RF Frontend Design</h1>
                <p class="project-subtitle">Complete 28GHz 5G RF Frontend with Beamforming Array</p>
            </div>

            <div class="project-content">
                <div class="section">
                    <h2><i class="fas fa-satellite-dish"></i> Project Overview</h2>
                    <p>This project presents a comprehensive design of a 28GHz 5G New Radio (NR) RF frontend system featuring advanced beamforming capabilities, high-efficiency GaN power amplifiers, and adaptive impedance matching networks. The system achieves industry-leading performance metrics with 35dBm output power, sub-6dB noise figure, and supports 256-QAM modulation for maximum data throughput.</p>
                    
                    <div class="tech-specs">
                        <h3>Key Specifications</h3>
                        <ul>
                            <li><strong>Frequency Band:</strong> 27.5-28.35 GHz (n257 band)</li>
                            <li><strong>Output Power:</strong> 35 dBm (3.16W) at P1dB</li>
                            <li><strong>Noise Figure:</strong> < 6 dB system NF</li>
                            <li><strong>Beamforming:</strong> 8x8 phased array with ±60° steering</li>
                            <li><strong>Modulation Support:</strong> Up to 256-QAM</li>
                            <li><strong>EVM:</strong> < 3.5% for 256-QAM</li>
                        </ul>
                    </div>
                </div>

                <div class="section">
                    <h2><i class="fas fa-microchip"></i> System Architecture</h2>
                    <div class="architecture-diagram">
                        <canvas id="systemBlockDiagram"></canvas>
                    </div>
                    <p>The RF frontend consists of four main subsystems:</p>
                    <ol>
                        <li><strong>Low Noise Amplifier (LNA):</strong> GaAs pHEMT design with 2.5dB NF</li>
                        <li><strong>Power Amplifier (PA):</strong> GaN HEMT with 40% PAE</li>
                        <li><strong>Beamforming Network:</strong> 8x8 Butler matrix with phase shifters</li>
                        <li><strong>Adaptive Matching:</strong> Varactor-based tunable networks</li>
                    </ol>
                </div>

                <div class="section">
                    <h2><i class="fas fa-wave-square"></i> Power Amplifier Design</h2>
                    <div class="subsection">
                        <h3>GaN HEMT Implementation</h3>
                        <div class="code-block">
                            <pre><code class="language-python">
# GaN PA Design Parameters
import numpy as np
import matplotlib.pyplot as plt

class GaN_PA_Design:
    def __init__(self):
        self.freq = 28e9  # 28 GHz
        self.Vds = 28     # Drain voltage
        self.Ids = 500    # Drain current (mA)
        self.gm = 0.35    # Transconductance (S)
        
    def calculate_load_impedance(self):
        """Calculate optimal load impedance for maximum power"""
        Pout_target = 35  # dBm
        Pout_W = 10**(Pout_target/10) / 1000
        
        # Load-pull analysis
        RL_opt = (self.Vds**2) / (2 * Pout_W)
        
        # Smith chart matching
        Z0 = 50
        gamma_L = (RL_opt - Z0) / (RL_opt + Z0)
        
        return RL_opt, gamma_L
    
    def design_output_match(self):
        """Design output matching network"""
        RL_opt, gamma_L = self.calculate_load_impedance()
        
        # Quarter-wave transformer
        lambda_4 = 3e8 / (4 * self.freq * np.sqrt(2.2))  # Er = 2.2
        Z_transform = np.sqrt(50 * RL_opt)
        
        return {
            'transformer_Z': Z_transform,
            'length_mm': lambda_4 * 1000,
            'substrate': 'Rogers RO3003',
            'loss_dB': 0.15
        }
                            </code></pre>
                        </div>
                    </div>
                    
                    <div class="subsection">
                        <h3>Load-Pull Contours</h3>
                        <div id="loadPullPlot"></div>
                    </div>
                </div>

                <div class="section">
                    <h2><i class="fas fa-broadcast-tower"></i> Beamforming Array Design</h2>
                    <div class="subsection">
                        <h3>8x8 Phased Array Configuration</h3>
                        <div class="array-visualization">
                            <canvas id="arrayPattern"></canvas>
                        </div>
                        
                        <div class="code-block">
                            <pre><code class="language-python">
# Beamforming Array Calculations
class BeamformingArray:
    def __init__(self):
        self.N = 8  # 8x8 array
        self.freq = 28e9
        self.c = 3e8
        self.lambda_0 = self.c / self.freq
        self.d = 0.5 * self.lambda_0  # Element spacing
        
    def calculate_array_factor(self, theta, phi, weights):
        """Calculate 3D array factor"""
        k = 2 * np.pi / self.lambda_0
        
        AF = 0
        for m in range(self.N):
            for n in range(self.N):
                phase = k * self.d * (m * np.sin(theta) * np.cos(phi) + 
                                      n * np.sin(theta) * np.sin(phi))
                AF += weights[m, n] * np.exp(1j * phase)
        
        return np.abs(AF)**2
    
    def beam_steering(self, theta_steer, phi_steer):
        """Calculate phase shifts for beam steering"""
        phases = np.zeros((self.N, self.N))
        k = 2 * np.pi / self.lambda_0
        
        for m in range(self.N):
            for n in range(self.N):
                phases[m, n] = -k * self.d * (
                    m * np.sin(theta_steer) * np.cos(phi_steer) +
                    n * np.sin(theta_steer) * np.sin(phi_steer)
                )
        
        return np.exp(1j * phases)
                            </code></pre>
                        </div>
                    </div>
                    
                    <div class="subsection">
                        <h3>Beam Steering Performance</h3>
                        <div class="performance-charts">
                            <div id="beamSteeringChart"></div>
                            <div id="gainVsAngleChart"></div>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h2><i class="fas fa-chart-line"></i> S-Parameter Analysis</h2>
                    <div class="s-parameters">
                        <div id="s11Plot"></div>
                        <div id="s21Plot"></div>
                    </div>
                    
                    <div class="measurement-data">
                        <h3>Measured Performance</h3>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Parameter</th>
                                    <th>Specification</th>
                                    <th>Measured</th>
                                    <th>Unit</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>S11 (Return Loss)</td>
                                    <td>< -15</td>
                                    <td>-18.5</td>
                                    <td>dB</td>
                                </tr>
                                <tr>
                                    <td>S21 (Gain)</td>
                                    <td>> 30</td>
                                    <td>32.5</td>
                                    <td>dB</td>
                                </tr>
                                <tr>
                                    <td>P1dB</td>
                                    <td>> 33</td>
                                    <td>35.2</td>
                                    <td>dBm</td>
                                </tr>
                                <tr>
                                    <td>PAE @ P1dB</td>
                                    <td>> 35</td>
                                    <td>40.5</td>
                                    <td>%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="section">
                    <h2><i class="fas fa-sliders-h"></i> Adaptive Impedance Matching</h2>
                    <div class="interactive-demo">
                        <h3>Interactive Smith Chart Matching</h3>
                        <div id="smithChart"></div>
                        
                        <div class="controls">
                            <label>Frequency (GHz): <span id="freqValue">28.0</span></label>
                            <input type="range" id="freqSlider" min="27.5" max="28.5" step="0.1" value="28.0">
                            
                            <label>VSWR Target: <span id="vswrValue">1.5</span></label>
                            <input type="range" id="vswrSlider" min="1.0" max="3.0" step="0.1" value="1.5">
                            
                            <button onclick="updateMatching()">Update Matching Network</button>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h2><i class="fas fa-thermometer-half"></i> Thermal Analysis</h2>
                    <div class="thermal-simulation">
                        <h3>Heat Dissipation Simulation</h3>
                        <div id="thermalPlot"></div>
                        <p>Thermal management is critical for GaN PA reliability. The design incorporates:</p>
                        <ul>
                            <li>Diamond heat spreader for junction temperature reduction</li>
                            <li>Micro-channel cooling with 50°C/W thermal resistance</li>
                            <li>Active thermal monitoring with temperature compensation</li>
                        </ul>
                    </div>
                </div>

                <div class="section">
                    <h2><i class="fas fa-tools"></i> Design Tools & Methodology</h2>
                    <div class="tools-grid">
                        <div class="tool-card">
                            <h4><i class="fas fa-wave-square"></i> Keysight ADS</h4>
                            <p>Circuit simulation, harmonic balance analysis, and EM co-simulation</p>
                        </div>
                        <div class="tool-card">
                            <h4><i class="fas fa-cube"></i> Ansys HFSS</h4>
                            <p>3D electromagnetic simulation for antenna arrays and passive structures</p>
                        </div>
                        <div class="tool-card">
                            <h4><i class="fas fa-chart-area"></i> AWR Microwave Office</h4>
                            <p>System-level simulation and yield analysis</p>
                        </div>
                        <div class="tool-card">
                            <h4><i class="fas fa-microchip"></i> Cadence Virtuoso</h4>
                            <p>IC layout and parasitic extraction</p>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h2><i class="fas fa-microscope"></i> Measurement & Validation</h2>
                    <div class="subsection">
                        <h3>Vector Network Analyzer Measurements</h3>
                        <div class="measurement-setup">
                            <p>Full two-port S-parameter characterization using Keysight PNA-X N5247B (10MHz-67GHz)</p>
                            <ul>
                                <li>Calibration: SOLT with electronic calibration module</li>
                                <li>Power sweep: -30dBm to +10dBm input</li>
                                <li>Temperature characterization: -40°C to +85°C</li>
                                <li>Load-pull measurements with automated tuner</li>
                            </ul>
                        </div>
                        
                        <h3>Over-the-Air Testing</h3>
                        <div id="otaTestResults"></div>
                    </div>
                </div>

                <div class="section">
                    <h2><i class="fas fa-project-diagram"></i> Complete Design Files</h2>
                    <div class="subsection">
                        <h3>Schematic & Layout Files</h3>
                        <div class="code-block">
                            <pre><code class="language-python">
# PCB Stack-up Configuration
stackup = {
    'layers': [
        {'name': 'Top', 'type': 'signal', 'thickness': 35, 'material': 'copper'},
        {'name': 'Prepreg-1', 'type': 'dielectric', 'thickness': 100, 'Er': 3.5},
        {'name': 'GND-1', 'type': 'plane', 'thickness': 35, 'material': 'copper'},
        {'name': 'Core-1', 'type': 'dielectric', 'thickness': 200, 'Er': 3.5},
        {'name': 'Signal-2', 'type': 'signal', 'thickness': 35, 'material': 'copper'},
        {'name': 'Prepreg-2', 'type': 'dielectric', 'thickness': 100, 'Er': 3.5},
        {'name': 'Signal-3', 'type': 'signal', 'thickness': 35, 'material': 'copper'},
        {'name': 'Core-2', 'type': 'dielectric', 'thickness': 200, 'Er': 3.5},
        {'name': 'GND-2', 'type': 'plane', 'thickness': 35, 'material': 'copper'},
        {'name': 'Prepreg-3', 'type': 'dielectric', 'thickness': 100, 'Er': 3.5},
        {'name': 'Bottom', 'type': 'signal', 'thickness': 35, 'material': 'copper'}
    ],
    'via_types': {
        'through': {'drill': 0.2, 'pad': 0.35, 'antipad': 0.5},
        'blind': {'drill': 0.1, 'pad': 0.2, 'antipad': 0.3},
        'buried': {'drill': 0.15, 'pad': 0.25, 'antipad': 0.35}
    }
}

# Transmission line calculator
def calculate_microstrip(w, h, er):
    """Calculate characteristic impedance of microstrip"""
    from numpy import log, sqrt, pi
    
    # Effective dielectric constant
    w_h = w / h
    if w_h <= 1:
        er_eff = (er + 1)/2 + (er - 1)/2 * (1/sqrt(1 + 12/w_h) + 0.04*(1 - w_h)**2)
    else:
        er_eff = (er + 1)/2 + (er - 1)/2 / sqrt(1 + 12/w_h)
    
    # Characteristic impedance
    if w_h <= 1:
        Z0 = 60/sqrt(er_eff) * log(8/w_h + w_h/4)
    else:
        Z0 = 120*pi / (sqrt(er_eff) * (w_h + 1.393 + 0.667*log(w_h + 1.444)))
    
    return Z0, er_eff
                            </code></pre>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h2><i class="fas fa-chart-line"></i> Performance Optimization</h2>
                    <div class="subsection">
                        <h3>Linearity Enhancement Techniques</h3>
                        <ul>
                            <li><strong>Digital Predistortion (DPD):</strong> Implemented adaptive DPD with memory polynomial model</li>
                            <li><strong>Envelope Tracking:</strong> Dynamic supply voltage modulation for efficiency improvement</li>
                            <li><strong>Crest Factor Reduction:</strong> Peak-to-average power ratio optimization</li>
                        </ul>
                        
                        <div class="code-block">
                            <pre><code class="language-python">
# Digital Predistortion Implementation
import numpy as np
from scipy.signal import lfilter

class DPD_System:
    def __init__(self, order=5, memory=3):
        self.order = order
        self.memory = memory
        self.coefficients = np.zeros((order, memory), dtype=complex)
        
    def adapt_coefficients(self, input_signal, output_signal):
        """Indirect learning architecture for DPD adaptation"""
        # Build basis functions matrix
        X = self.build_basis_matrix(output_signal)
        
        # Least squares solution
        self.coefficients = np.linalg.lstsq(X, input_signal, rcond=None)[0]
        
    def predistort(self, signal):
        """Apply predistortion to input signal"""
        predistorted = np.zeros_like(signal)
        
        for k in range(self.order):
            for m in range(self.memory):
                if m == 0:
                    basis = signal * np.abs(signal)**(2*k)
                else:
                    basis = np.roll(signal, m) * np.abs(np.roll(signal, m))**(2*k)
                
                predistorted += self.coefficients[k, m] * basis
        
        return predistorted
                            </code></pre>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h2><i class="fas fa-download"></i> Resources & Documentation</h2>
                    <div class="resources">
                        <a href="mmwave-rf-paper.html" class="resource-link">
                            <i class="fas fa-file-alt"></i> Full Research Paper
                        </a>
                        <a href="#" class="resource-link">
                            <i class="fas fa-file-pdf"></i> Design Report (PDF)
                        </a>
                        <a href="#" class="resource-link">
                            <i class="fas fa-code"></i> MATLAB/Python Scripts
                        </a>
                        <a href="#" class="resource-link">
                            <i class="fas fa-file-archive"></i> S-Parameter Files
                        </a>
                        <a href="#" class="resource-link">
                            <i class="fas fa-video"></i> Demo Video
                        </a>
                        <a href="#" class="resource-link">
                            <i class="fab fa-github"></i> GitHub Repository
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <style>
        .project-detail {
            padding: 80px 0;
            min-height: 100vh;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
        }

        .project-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .project-header h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
        }

        .project-subtitle {
            color: #888;
            font-size: 1.2rem;
        }

        .section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .section h2 {
            color: #667eea;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tech-specs ul {
            list-style: none;
            padding: 0;
        }

        .tech-specs li {
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .code-block {
            background: #1a1a1a;
            border-radius: 10px;
            padding: 1rem;
            overflow-x: auto;
            margin: 1rem 0;
        }

        .code-block pre {
            margin: 0;
            color: #f8f8f2;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        .data-table th {
            background: rgba(102, 126, 234, 0.2);
            padding: 0.75rem;
            text-align: left;
            color: #fff;
        }

        .data-table td {
            padding: 0.75rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            color: #ccc;
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .tool-card {
            background: rgba(102, 126, 234, 0.1);
            padding: 1rem;
            border-radius: 10px;
            border: 1px solid rgba(102, 126, 234, 0.2);
        }

        .tool-card h4 {
            color: #667eea;
            margin-bottom: 0.5rem;
        }

        .resources {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .resource-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: rgba(102, 126, 234, 0.2);
            border-radius: 25px;
            color: #667eea;
            text-decoration: none;
            transition: all 0.3s;
        }

        .resource-link:hover {
            background: rgba(102, 126, 234, 0.3);
            transform: translateY(-2px);
        }

        .controls {
            background: rgba(0, 0, 0, 0.3);
            padding: 1rem;
            border-radius: 10px;
            margin: 1rem 0;
        }

        .controls label {
            display: block;
            color: #ccc;
            margin: 0.5rem 0;
        }

        .controls input[type="range"] {
            width: 100%;
            margin: 0.5rem 0;
        }

        .controls button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .controls button:hover {
            transform: translateY(-2px);
        }

        #systemBlockDiagram, #arrayPattern {
            width: 100%;
            height: 400px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            margin: 1rem 0;
        }

        .performance-charts {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin: 1rem 0;
        }

        .s-parameters {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin: 1rem 0;
        }
    </style>

    <script>
        // Initialize all plots and interactive elements
        document.addEventListener('DOMContentLoaded', function() {
            // S11 Plot (Return Loss)
            const s11Data = {
                x: Array.from({length: 100}, (_, i) => 27 + i * 0.015),
                y: Array.from({length: 100}, (_, i) => {
                    const f = 27 + i * 0.015;
                    return -15 - 10 * Math.exp(-Math.pow((f - 28) / 0.5, 2));
                }),
                type: 'scatter',
                name: 'S11',
                line: {color: '#667eea'}
            };

            const s11Layout = {
                title: 'S11 Return Loss vs Frequency',
                xaxis: {title: 'Frequency (GHz)'},
                yaxis: {title: 'S11 (dB)'},
                paper_bgcolor: 'rgba(0,0,0,0.3)',
                plot_bgcolor: 'rgba(0,0,0,0.3)',
                font: {color: '#ccc'}
            };

            Plotly.newPlot('s11Plot', [s11Data], s11Layout);

            // S21 Plot (Gain)
            const s21Data = {
                x: Array.from({length: 100}, (_, i) => 27 + i * 0.015),
                y: Array.from({length: 100}, (_, i) => {
                    const f = 27 + i * 0.015;
                    return 32.5 - 2 * Math.pow((f - 28) / 1.5, 2);
                }),
                type: 'scatter',
                name: 'S21',
                line: {color: '#764ba2'}
            };

            const s21Layout = {
                title: 'S21 Gain vs Frequency',
                xaxis: {title: 'Frequency (GHz)'},
                yaxis: {title: 'S21 (dB)'},
                paper_bgcolor: 'rgba(0,0,0,0.3)',
                plot_bgcolor: 'rgba(0,0,0,0.3)',
                font: {color: '#ccc'}
            };

            Plotly.newPlot('s21Plot', [s21Data], s21Layout);

            // Load-Pull Contours
            const loadPullData = [];
            const levels = [30, 31, 32, 33, 34, 35];
            
            for (let level of levels) {
                const theta = Array.from({length: 100}, (_, i) => i * 2 * Math.PI / 100);
                const r = 0.3 + (35 - level) * 0.1;
                
                loadPullData.push({
                    x: theta.map(t => r * Math.cos(t)),
                    y: theta.map(t => r * Math.sin(t)),
                    type: 'scatter',
                    name: `${level} dBm`,
                    line: {color: `hsl(${280 - level * 5}, 70%, 50%)`}
                });
            }

            const loadPullLayout = {
                title: 'Load-Pull Power Contours (Smith Chart)',
                xaxis: {title: 'Real', range: [-1, 1]},
                yaxis: {title: 'Imaginary', range: [-1, 1]},
                paper_bgcolor: 'rgba(0,0,0,0.3)',
                plot_bgcolor: 'rgba(0,0,0,0.3)',
                font: {color: '#ccc'},
                showlegend: true
            };

            Plotly.newPlot('loadPullPlot', loadPullData, loadPullLayout);

            // Beam Steering Chart
            const angles = Array.from({length: 121}, (_, i) => i - 60);
            const gain = angles.map(a => 20 * Math.log10(Math.abs(Math.sin(64 * Math.PI * Math.sin(a * Math.PI / 180)) / 
                                                                  (64 * Math.sin(Math.PI * Math.sin(a * Math.PI / 180))))));

            const beamData = {
                x: angles,
                y: gain,
                type: 'scatter',
                fill: 'tozeroy',
                line: {color: '#667eea'}
            };

            const beamLayout = {
                title: 'Array Pattern (8x8)',
                xaxis: {title: 'Angle (degrees)'},
                yaxis: {title: 'Gain (dB)'},
                paper_bgcolor: 'rgba(0,0,0,0.3)',
                plot_bgcolor: 'rgba(0,0,0,0.3)',
                font: {color: '#ccc'}
            };

            Plotly.newPlot('beamSteeringChart', [beamData], beamLayout);

            // Thermal Plot
            const thermalX = Array.from({length: 50}, (_, i) => i);
            const thermalY = Array.from({length: 50}, (_, i) => i);
            const thermalZ = [];
            
            for (let i = 0; i < 50; i++) {
                thermalZ[i] = [];
                for (let j = 0; j < 50; j++) {
                    const dist = Math.sqrt(Math.pow(i - 25, 2) + Math.pow(j - 25, 2));
                    thermalZ[i][j] = 85 * Math.exp(-dist / 10) + 25;
                }
            }

            const thermalData = [{
                x: thermalX,
                y: thermalY,
                z: thermalZ,
                type: 'heatmap',
                colorscale: 'Hot'
            }];

            const thermalLayout = {
                title: 'Junction Temperature Distribution (°C)',
                paper_bgcolor: 'rgba(0,0,0,0.3)',
                plot_bgcolor: 'rgba(0,0,0,0.3)',
                font: {color: '#ccc'}
            };

            Plotly.newPlot('thermalPlot', thermalData, thermalLayout);

            // System Block Diagram
            const canvas = document.getElementById('systemBlockDiagram');
            const ctx = canvas.getContext('2d');
            canvas.width = canvas.offsetWidth;
            canvas.height = 400;

            // Draw block diagram
            ctx.fillStyle = '#667eea';
            ctx.strokeStyle = '#667eea';
            ctx.lineWidth = 2;

            // Draw blocks
            const blocks = [
                {x: 50, y: 150, w: 100, h: 60, label: 'RF Input'},
                {x: 200, y: 150, w: 100, h: 60, label: 'LNA'},
                {x: 350, y: 150, w: 100, h: 60, label: 'Mixer'},
                {x: 500, y: 150, w: 100, h: 60, label: 'PA'},
                {x: 650, y: 150, w: 100, h: 60, label: 'Array'}
            ];

            blocks.forEach(block => {
                ctx.strokeRect(block.x, block.y, block.w, block.h);
                ctx.fillStyle = '#fff';
                ctx.font = '14px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(block.label, block.x + block.w/2, block.y + block.h/2 + 5);
            });

            // Draw connections
            ctx.strokeStyle = '#764ba2';
            for (let i = 0; i < blocks.length - 1; i++) {
                ctx.beginPath();
                ctx.moveTo(blocks[i].x + blocks[i].w, blocks[i].y + blocks[i].h/2);
                ctx.lineTo(blocks[i+1].x, blocks[i+1].y + blocks[i+1].h/2);
                ctx.stroke();
            }

            // Draw Array Pattern
            const arrayCanvas = document.getElementById('arrayPattern');
            const arrayCtx = arrayCanvas.getContext('2d');
            arrayCanvas.width = arrayCanvas.offsetWidth;
            arrayCanvas.height = 400;

            // Draw 8x8 array elements
            const elementSize = 30;
            const spacing = 40;
            const startX = (arrayCanvas.width - 8 * spacing) / 2;
            const startY = (arrayCanvas.height - 8 * spacing) / 2;

            for (let i = 0; i < 8; i++) {
                for (let j = 0; j < 8; j++) {
                    const x = startX + i * spacing;
                    const y = startY + j * spacing;
                    
                    // Draw element
                    arrayCtx.fillStyle = `rgba(102, 126, 234, ${0.3 + 0.7 * Math.random()})`;
                    arrayCtx.fillRect(x, y, elementSize, elementSize);
                    
                    // Draw phase indicator
                    arrayCtx.strokeStyle = '#764ba2';
                    arrayCtx.beginPath();
                    arrayCtx.arc(x + elementSize/2, y + elementSize/2, 10, 0, 2 * Math.PI);
                    arrayCtx.stroke();
                }
            }

            // Interactive Smith Chart
            const smithCanvas = document.getElementById('smithChart');
            if (smithCanvas) {
                const smithData = [{
                    r: [0, 0.2, 0.5, 1, 2, 5],
                    x: [-5, -2, -1, -0.5, -0.2, 0, 0.2, 0.5, 1, 2, 5],
                    type: 'smith'
                }];

                const smithLayout = {
                    title: 'Interactive Smith Chart',
                    paper_bgcolor: 'rgba(0,0,0,0.3)',
                    plot_bgcolor: 'rgba(0,0,0,0.3)',
                    font: {color: '#ccc'}
                };

                // Fallback to regular plot if smith chart type not available
                const fallbackData = {
                    x: [0.3, 0.5, 0.7, 0.4],
                    y: [0.2, 0.4, 0.1, -0.2],
                    type: 'scatter',
                    mode: 'lines+markers',
                    line: {color: '#667eea'}
                };

                Plotly.newPlot('smithChart', [fallbackData], smithLayout);
            }
        });

        // Slider interactions
        document.getElementById('freqSlider').addEventListener('input', function(e) {
            document.getElementById('freqValue').textContent = e.target.value;
        });

        document.getElementById('vswrSlider').addEventListener('input', function(e) {
            document.getElementById('vswrValue').textContent = e.target.value;
        });

        function updateMatching() {
            // Simulate matching network update
            alert('Matching network updated for new parameters!');
        }
    </script>
</body>
</html>