<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Silicon Photonics - Microring Resonator WDM Filter | Louis Antoine Portfolio</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #0a0a0a;
            color: #e0e0e0;
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            width: 100%;
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(10px);
            z-index: 1000;
            padding: 1rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        nav .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        nav h1 {
            font-size: 1.5rem;
            color: #4fc3f7;
        }
        
        nav a {
            color: #e0e0e0;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            transition: all 0.3s ease;
        }
        
        nav a:hover {
            background: rgba(79, 195, 247, 0.1);
            color: #4fc3f7;
        }
        
        /* Hero Section */
        .hero {
            position: relative;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
            overflow: hidden;
            margin-top: 60px;
        }
        
        #photonics-animation {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.3;
        }
        
        .hero-content {
            position: relative;
            z-index: 2;
            text-align: center;
            padding: 2rem;
            max-width: 800px;
        }
        
        .hero h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            background: linear-gradient(45deg, #4fc3f7, #29b6f6, #81c784);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from { filter: drop-shadow(0 0 20px rgba(79, 195, 247, 0.5)); }
            to { filter: drop-shadow(0 0 30px rgba(79, 195, 247, 0.8)); }
        }
        
        .hero p {
            font-size: 1.3rem;
            margin-bottom: 2rem;
            color: #b0b0b0;
        }
        
        .hero-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid rgba(79, 195, 247, 0.3);
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            border-color: rgba(79, 195, 247, 0.6);
            box-shadow: 0 10px 30px rgba(79, 195, 247, 0.2);
        }
        
        .stat-card h3 {
            font-size: 2rem;
            color: #4fc3f7;
            margin-bottom: 0.5rem;
        }
        
        .stat-card p {
            font-size: 0.9rem;
            color: #888;
        }
        
        /* Section Styles */
        section {
            padding: 4rem 0;
            position: relative;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }
        
        h2 {
            font-size: 2.5rem;
            margin-bottom: 2rem;
            text-align: center;
            color: #4fc3f7;
            position: relative;
            padding-bottom: 1rem;
        }
        
        h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 3px;
            background: linear-gradient(90deg, transparent, #4fc3f7, transparent);
        }
        
        /* Card Grid */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 2rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(79, 195, 247, 0.1) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .card:hover::before {
            opacity: 1;
        }
        
        .card:hover {
            transform: translateY(-5px);
            border-color: rgba(79, 195, 247, 0.3);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }
        
        .card h3 {
            font-size: 1.5rem;
            margin-bottom: 1rem;
            color: #81c784;
        }
        
        .card-icon {
            font-size: 3rem;
            color: #4fc3f7;
            margin-bottom: 1rem;
        }
        
        /* Visualization Container */
        .viz-container {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 2rem;
            margin: 2rem 0;
            min-height: 500px;
        }
        
        /* Demo Links */
        .demo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }
        
        .demo-card {
            background: linear-gradient(135deg, rgba(79, 195, 247, 0.1), rgba(129, 199, 132, 0.1));
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            text-decoration: none;
            color: inherit;
            display: block;
        }
        
        .demo-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(79, 195, 247, 0.2);
            border-color: rgba(79, 195, 247, 0.5);
        }
        
        .demo-card i {
            font-size: 3rem;
            color: #4fc3f7;
            margin-bottom: 1rem;
            display: block;
        }
        
        .demo-card h3 {
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
            color: #e0e0e0;
        }
        
        .demo-card p {
            font-size: 0.9rem;
            color: #888;
        }
        
        /* Code Block */
        .code-block {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 10px;
            padding: 1.5rem;
            overflow-x: auto;
            margin: 2rem 0;
        }
        
        .code-block pre {
            color: #e6edf3;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
        }
        
        /* Timeline */
        .timeline {
            position: relative;
            padding: 2rem 0;
            margin: 3rem 0;
        }
        
        .timeline::before {
            content: '';
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(180deg, #4fc3f7, #81c784);
            transform: translateX(-50%);
        }
        
        .timeline-item {
            position: relative;
            padding: 2rem;
            width: calc(50% - 2rem);
            margin-bottom: 2rem;
        }
        
        .timeline-item:nth-child(odd) {
            left: 0;
            text-align: right;
        }
        
        .timeline-item:nth-child(even) {
            left: calc(50% + 2rem);
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            background: #4fc3f7;
            border-radius: 50%;
            top: 2rem;
        }
        
        .timeline-item:nth-child(odd)::before {
            right: -2.5rem;
        }
        
        .timeline-item:nth-child(even)::before {
            left: -2.5rem;
        }
        
        .timeline-content {
            background: rgba(255, 255, 255, 0.05);
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .timeline-content h3 {
            color: #81c784;
            margin-bottom: 0.5rem;
        }
        
        .timeline-content p {
            color: #b0b0b0;
            font-size: 0.9rem;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2.5rem;
            }
            
            .timeline::before {
                left: 2rem;
            }
            
            .timeline-item {
                width: calc(100% - 4rem);
                left: 4rem !important;
                text-align: left !important;
            }
            
            .timeline-item::before {
                left: -2.5rem !important;
            }
        }
        
        /* Software Stack Table */
        .software-table {
            width: 100%;
            border-collapse: collapse;
            margin: 2rem 0;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .software-table th,
        .software-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .software-table th {
            background: rgba(79, 195, 247, 0.1);
            color: #4fc3f7;
            font-weight: 600;
        }
        
        .software-table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        
        .software-table td:first-child {
            font-weight: 500;
            color: #81c784;
        }
        
        /* Specs Table */
        .specs-table {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }
        
        .spec-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .spec-item .spec-label {
            color: #888;
            font-size: 0.9rem;
        }
        
        .spec-item .spec-value {
            color: #4fc3f7;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        /* Info Box */
        .info-box {
            background: rgba(79, 195, 247, 0.1);
            border-left: 4px solid #4fc3f7;
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 5px;
        }
        
        .info-box h4 {
            color: #4fc3f7;
            margin-bottom: 0.5rem;
        }
        
        .info-box p {
            color: #b0b0b0;
            font-size: 0.95rem;
        }
        
        /* Workflow Steps */
        .workflow-steps {
            display: grid;
            gap: 2rem;
            margin: 3rem 0;
        }
        
        .workflow-step {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 2rem;
            align-items: start;
        }
        
        .step-number {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #4fc3f7, #81c784);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: #0a0a0a;
        }
        
        .step-content {
            background: rgba(255, 255, 255, 0.03);
            padding: 2rem;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .step-content h3 {
            color: #81c784;
            margin-bottom: 1rem;
        }
        
        .step-content p {
            color: #b0b0b0;
            margin-bottom: 1rem;
        }
        
        .step-content .code-snippet {
            background: #0d1117;
            padding: 1rem;
            border-radius: 5px;
            font-family: monospace;
            color: #58a6ff;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav>
        <div class="container">
            <h1>Silicon Photonics Project</h1>
            <a href="index.html">← Back to Portfolio</a>
        </div>
    </nav>
    
    <!-- Hero Section -->
    <section class="hero">
        <canvas id="photonics-animation"></canvas>
        <div class="hero-content">
            <h1>Silicon Microring Resonator</h1>
            <p>WDM Drop Filter @ 1550nm - Weekend Photonics Project</p>
            <div class="hero-stats">
                <div class="stat-card">
                    <h3>1550nm</h3>
                    <p>Center Wavelength</p>
                </div>
                <div class="stat-card">
                    <h3>Q ≈ 1950</h3>
                    <p>Quality Factor</p>
                </div>
                <div class="stat-card">
                    <h3>≥20dB</h3>
                    <p>Extinction Ratio</p>
                </div>
                <div class="stat-card">
                    <h3>100GHz</h3>
                    <p>Free Spectral Range</p>
                </div>
                <div class="stat-card">
                    <h3>&lt;30µm²</h3>
                    <p>Footprint</p>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Project Overview -->
    <section>
        <div class="container">
            <h2>Project Overview</h2>
            <div class="info-box">
                <h4>Why This Project?</h4>
                <p>Silicon microring resonators offer a perfect introduction to integrated photonics: simple geometry yet rich physics, 
                runs on free/academic software, and provides skills directly transferable to complex PIC designs. Master resonance, 
                Q-factor, and coupling in a weekend!</p>
            </div>
            
            <div class="card-grid">
                <div class="card">
                    <i class="fas fa-microchip card-icon"></i>
                    <h3>Compact Design</h3>
                    <p>Ultra-small footprint (&lt;30µm × 30µm) with powerful wavelength selectivity. 
                    Ideal for dense photonic integration and WDM applications.</p>
                </div>
                <div class="card">
                    <i class="fas fa-wave-square card-icon"></i>
                    <h3>Rich Physics</h3>
                    <p>Explore resonance conditions, quality factors, coupling coefficients, and 
                    free spectral range through hands-on simulation.</p>
                </div>
                <div class="card">
                    <i class="fas fa-tools card-icon"></i>
                    <h3>Industry Workflow</h3>
                    <p>Learn the complete PIC design flow: layout → mode solving → FDTD → 
                    compact modeling → circuit verification.</p>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Software Stack -->
    <section style="background: rgba(255, 255, 255, 0.02);">
        <div class="container">
            <h2>Software Stack</h2>
            <p style="text-align: center; color: #888; margin-bottom: 2rem;">
                Choose your preferred tools - all options support the complete workflow
            </p>
            
            <table class="software-table">
                <thead>
                    <tr>
                        <th>Task</th>
                        <th>Open-Source / Free-Tier</th>
                        <th>Commercial (Trial/Edu)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Layout & Scripting</td>
                        <td>gdsfactory (Python) or KLayout + SiEPIC</td>
                        <td>Ansys Lumerical Layout</td>
                    </tr>
                    <tr>
                        <td>Eigen-mode Solver</td>
                        <td>mode_solver.py in Meep or MPB</td>
                        <td>Ansys MODE</td>
                    </tr>
                    <tr>
                        <td>3D FDTD</td>
                        <td>Meep or Flexcompute Tidy3D (GPU cloud)</td>
                        <td>Ansys FDTD (2025 R1 trial)</td>
                    </tr>
                    <tr>
                        <td>Circuit Verification</td>
                        <td>Caphe in gdsfactory or simphony</td>
                        <td>Ansys INTERCONNECT</td>
                    </tr>
                </tbody>
            </table>
            
            <div class="info-box">
                <h4>Quick Start</h4>
                <p>All tools install with pip or run in the browser. gdsfactory even autogenerates Meep/Tidy3D scripts 
                from your GDS layout. Check the awesome-photonics repo for alternative tools!</p>
            </div>
        </div>
    </section>
    
    <!-- Design Specifications -->
    <section>
        <div class="container">
            <h2>Design Specifications</h2>
            <div class="specs-table">
                <div class="spec-item">
                    <span class="spec-label">Center Wavelength</span>
                    <span class="spec-value">1550 nm</span>
                </div>
                <div class="spec-item">
                    <span class="spec-label">FWHM</span>
                    <span class="spec-value">≈ 0.8 nm</span>
                </div>
                <div class="spec-item">
                    <span class="spec-label">Quality Factor</span>
                    <span class="spec-value">Q ≈ 1950</span>
                </div>
                <div class="spec-item">
                    <span class="spec-label">Extinction Ratio</span>
                    <span class="spec-value">≥ 20 dB</span>
                </div>
                <div class="spec-item">
                    <span class="spec-label">Free Spectral Range</span>
                    <span class="spec-value">≈ 100 GHz</span>
                </div>
                <div class="spec-item">
                    <span class="spec-label">Footprint</span>
                    <span class="spec-value">≤ 30µm × 30µm</span>
                </div>
            </div>
            
            <!-- Ring Resonator Visualization -->
            <div class="viz-container">
                <h3 style="text-align: center; color: #81c784; margin-bottom: 1rem;">Microring Resonator Design</h3>
                <div id="ring-design-viz"></div>
            </div>
        </div>
    </section>
    
    <!-- Step-by-Step Workflow -->
    <section style="background: rgba(255, 255, 255, 0.02);">
        <div class="container">
            <h2>Step-by-Step Workflow</h2>
            
            <div class="workflow-steps">
                <div class="workflow-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h3>Layout Parametric Cell</h3>
                        <p>Create the ring resonator geometry using gdsfactory's parametric components.</p>
                        <div class="code-snippet">
                            c = gf.components.ring_single(radius=7, gap=0.15)
                        </div>
                        <p style="margin-top: 1rem; font-style: italic; color: #888;">
                            💡 Keep waveguide width at 450nm for Si PIC foundry compatibility
                        </p>
                    </div>
                </div>
                
                <div class="workflow-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h3>Mode-Solver Check</h3>
                        <p>Sweep waveguide width & slab height to extract effective refractive index (n_eff).</p>
                        <p>A quick 2D solver run tells you if the ring will be single-mode.</p>
                    </div>
                </div>
                
                <div class="workflow-step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h3>3D FDTD Sweep</h3>
                        <p>Automate parameter sweeps: radius (6-8 µm) & gap (0.12-0.25 µm). Measure S-parameters.</p>
                        <p style="margin-top: 1rem; font-style: italic; color: #888;">
                            💡 Meep/Tidy3D jobs finish in minutes on a GPU instance
                        </p>
                    </div>
                </div>
                
                <div class="workflow-step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h3>Extract Metrics</h3>
                        <p>From the transmission spectrum, fit Lorentzian → Q, FSR, ER.</p>
                        <div class="code-snippet">
                            scipy.optimize.curve_fit(lorentzian, wavelength, transmission)
                        </div>
                    </div>
                </div>
                
                <div class="workflow-step">
                    <div class="step-number">5</div>
                    <div class="step-content">
                        <h3>Build Compact Model</h3>
                        <p>Convert fitted parameters to an INTERCONNECT or Caphe ring component.</p>
                        <p>Drop the device into a larger NRZ/PAM-4 link to see eye-diagrams.</p>
                    </div>
                </div>
                
                <div class="workflow-step">
                    <div class="step-number">6</div>
                    <div class="step-content">
                        <h3>(Optional) Inverse-Design Tweak</h3>
                        <p>With Tidy3D's autodiff API, optimize the bus-ring gap profile for max ER.</p>
                        <p>TidyGrad examples show 10-line scripts that converge in &lt;50 iterations.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Interactive Demonstrations -->
    <section>
        <div class="container">
            <h2>Interactive Demonstrations</h2>
            <p style="text-align: center; color: #888; margin-bottom: 2rem;">
                Explore the physics and design process through interactive tools
            </p>
            
            <div class="demo-grid">
                <a href="silicon-photonics-files/ring-resonator-simulator.html" class="demo-card">
                    <i class="fas fa-ring"></i>
                    <h3>Ring Resonator Simulator</h3>
                    <p>Interactive design tool with real-time spectral response</p>
                </a>
                
                <a href="silicon-photonics-files/fdtd-results-viewer.html" class="demo-card">
                    <i class="fas fa-chart-line"></i>
                    <h3>FDTD Results Viewer</h3>
                    <p>Visualize field distributions and S-parameter sweeps</p>
                </a>
                
                <a href="silicon-photonics-files/parameter-sweep-dashboard.html" class="demo-card">
                    <i class="fas fa-sliders-h"></i>
                    <h3>Parameter Sweep Dashboard</h3>
                    <p>Explore design space and optimization landscapes</p>
                </a>
                
                <a href="silicon-photonics-files/compact-model-builder.html" class="demo-card">
                    <i class="fas fa-project-diagram"></i>
                    <h3>Compact Model Builder</h3>
                    <p>Extract and validate behavioral models from FDTD data</p>
                </a>
                
                <a href="silicon-photonics-files/circuit-simulator.html" class="demo-card">
                    <i class="fas fa-network-wired"></i>
                    <h3>PIC Circuit Simulator</h3>
                    <p>Test ring filters in complete photonic circuits</p>
                </a>
                
                <a href="silicon-photonics-files/technical-docs.html" class="demo-card">
                    <i class="fas fa-book"></i>
                    <h3>Technical Documentation</h3>
                    <p>Detailed theory, equations, and implementation guides</p>
                </a>
            </div>
        </div>
    </section>
    
    <!-- Performance Analysis -->
    <section style="background: rgba(255, 255, 255, 0.02);">
        <div class="container">
            <h2>Performance Analysis</h2>
            
            <div class="viz-container">
                <h3 style="text-align: center; color: #81c784; margin-bottom: 1rem;">Transmission Spectrum & Q-Factor Analysis</h3>
                <div id="transmission-spectrum"></div>
            </div>
            
            <div class="viz-container" style="margin-top: 2rem;">
                <h3 style="text-align: center; color: #81c784; margin-bottom: 1rem;">Design Space Exploration</h3>
                <div id="design-space"></div>
            </div>
        </div>
    </section>
    
    <!-- Code Example -->
    <section>
        <div class="container">
            <h2>Implementation Example</h2>
            <p style="text-align: center; color: #888; margin-bottom: 2rem;">
                Complete Python workflow for ring resonator design and analysis
            </p>
            
            <div class="code-block">
                <pre><code>import gdsfactory as gf
import numpy as np
from scipy.optimize import curve_fit
import matplotlib.pyplot as plt

# Step 1: Create parametric ring resonator
def create_ring_filter(radius=7, gap=0.15, width=0.45):
    """Create a single ring resonator drop filter"""
    c = gf.Component()
    
    # Create ring and bus waveguides
    ring = c.add_ref(gf.components.ring(radius=radius, width=width))
    bus = c.add_ref(gf.components.straight(length=2*radius+10))
    
    # Position bus waveguide with specified gap
    bus.movey(-radius - width/2 - gap - width/2)
    
    # Add ports
    c.add_port("in", port=bus.ports["o1"])
    c.add_port("through", port=bus.ports["o2"])
    c.add_port("drop", port=ring.ports["o2"])
    c.add_port("add", port=ring.ports["o1"])
    
    return c

# Step 2: FDTD simulation setup (using Tidy3D)
def simulate_ring(component, wavelengths):
    """Run FDTD simulation and extract S-parameters"""
    import tidy3d as td
    
    # Convert GDS to simulation geometry
    sim = gf.plugins.tidy3d.get_simulation(
        component=component,
        wavelength=1.55,
        wavelength_span=0.1,
        port_source="in",
        port_monitors=["through", "drop"],
        mesh_accuracy=3
    )
    
    # Run simulation
    data = td.web.run(sim, task_name="ring_resonator")
    
    # Extract S-parameters
    S21 = data["through"].amps
    S31 = data["drop"].amps
    
    return S21, S31

# Step 3: Analyze resonances
def lorentzian(x, x0, gamma, A, offset):
    """Lorentzian function for resonance fitting"""
    return A * gamma**2 / ((x - x0)**2 + gamma**2) + offset

def extract_metrics(wavelengths, transmission):
    """Extract Q-factor, FSR, and extinction ratio"""
    # Find resonances
    from scipy.signal import find_peaks
    peaks, _ = find_peaks(-transmission, height=0.1)
    
    # Fit Lorentzian to each resonance
    metrics = []
    for peak in peaks:
        # Select data around peak
        idx_range = slice(max(0, peak-20), min(len(wavelengths), peak+20))
        x_fit = wavelengths[idx_range]
        y_fit = transmission[idx_range]
        
        # Initial guess
        x0_guess = wavelengths[peak]
        gamma_guess = 0.0004  # ~0.8nm FWHM
        A_guess = 1 - np.min(y_fit)
        offset_guess = np.max(y_fit)
        
        # Fit
        popt, _ = curve_fit(lorentzian, x_fit, y_fit, 
                           p0=[x0_guess, gamma_guess, A_guess, offset_guess])
        
        # Calculate metrics
        resonance_wavelength = popt[0]
        fwhm = 2 * popt[1]
        Q_factor = resonance_wavelength / fwhm
        extinction_ratio_dB = -10 * np.log10(np.min(y_fit) / np.max(y_fit))
        
        metrics.append({
            'wavelength': resonance_wavelength,
            'Q': Q_factor,
            'ER_dB': extinction_ratio_dB,
            'FWHM_nm': fwhm * 1000  # Convert to nm
        })
    
    # Calculate FSR
    if len(metrics) > 1:
        fsr_nm = np.diff([m['wavelength'] for m in metrics]).mean() * 1000
        fsr_ghz = 3e8 / (1.55e-6)**2 * fsr_nm * 1e-9 * 1e9  # Convert to GHz
    else:
        fsr_nm = fsr_ghz = None
    
    return metrics, fsr_ghz

# Step 4: Parameter sweep
def sweep_design_space():
    """Sweep radius and gap to optimize performance"""
    radii = np.linspace(6, 8, 5)
    gaps = np.linspace(0.12, 0.25, 5)
    
    results = []
    for radius in radii:
        for gap in gaps:
            # Create design
            ring = create_ring_filter(radius=radius, gap=gap)
            
            # Simulate (simplified - would use actual FDTD)
            # Here we use analytical approximation
            Q_loaded = estimate_Q(radius, gap)
            ER = estimate_ER(gap)
            
            results.append({
                'radius': radius,
                'gap': gap,
                'Q': Q_loaded,
                'ER_dB': ER
            })
    
    return results

# Helper functions for analytical estimates
def estimate_Q(radius, gap):
    """Estimate loaded Q-factor"""
    # Coupling coefficient (empirical model)
    kappa = np.exp(-2 * gap / 0.1)  # Simplified exponential model
    
    # Intrinsic Q (loss-limited)
    Q_intrinsic = 50000  # Typical for low-loss SOI
    
    # Loaded Q
    Q_loaded = Q_intrinsic / (1 + kappa * Q_intrinsic)
    
    return Q_loaded

def estimate_ER(gap):
    """Estimate extinction ratio"""
    kappa = np.exp(-2 * gap / 0.1)
    ER_linear = (1 - kappa)**2 / (4 * kappa)
    return 10 * np.log10(ER_linear)

# Step 5: Generate compact model
def create_compact_model(ring_params, s_params):
    """Generate Caphe/INTERCONNECT compatible model"""
    model = {
        'type': 'ring_resonator',
        'parameters': ring_params,
        'ports': ['in', 'through', 'drop', 'add'],
        's_parameters': s_params,
        'center_wavelength': 1.55e-6,
        'ng': 4.2,  # Group index
        'loss_dB_per_cm': 2.0
    }
    
    return model

# Main execution
if __name__ == "__main__":
    # Create optimized design
    ring = create_ring_filter(radius=7.2, gap=0.18)
    
    # Export GDS
    ring.write_gds("ring_filter.gds")
    
    # Run parameter sweep
    results = sweep_design_space()
    
    # Find optimal design
    optimal = max(results, key=lambda x: x['ER_dB'] if x['Q'] > 1500 else 0)
    
    print(f"Optimal Design:")
    print(f"  Radius: {optimal['radius']:.1f} µm")
    print(f"  Gap: {optimal['gap']:.3f} µm")
    print(f"  Q-factor: {optimal['Q']:.0f}")
    print(f"  Extinction Ratio: {optimal['ER_dB']:.1f} dB")
</code></pre>
            </div>
        </div>
    </section>
    
    <!-- Project Extensions -->
    <section style="background: rgba(255, 255, 255, 0.02);">
        <div class="container">
            <h2>Project Extensions</h2>
            <p style="text-align: center; color: #888; margin-bottom: 2rem;">
                Take your design further with these advanced features
            </p>
            
            <div class="card-grid">
                <div class="card">
                    <i class="fas fa-temperature-high card-icon"></i>
                    <h3>Thermo-Optic Tuning</h3>
                    <p>Add a heater layer in layout & simulate Δn(T). Demonstrates active control 
                    using coupled-mode theory. Essential for practical WDM systems.</p>
                </div>
                
                <div class="card">
                    <i class="fas fa-layer-group card-icon"></i>
                    <h3>Ring-Array Vernier Filter</h3>
                    <p>Cascade rings of different radii for >40 dB rejection. Perfect for 
                    dense WDM applications requiring ultra-narrow filtering.</p>
                </div>
                
                <div class="card">
                    <i class="fas fa-lock card-icon"></i>
                    <h3>MZI Wavelength Locker</h3>
                    <p>Use the ring as a feedback sensor in a control loop. Combines photonics 
                    with control theory - impressive for technical interviews!</p>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Deliverables -->
    <section>
        <div class="container">
            <h2>Project Deliverables</h2>
            
            <div class="workflow-steps">
                <div class="workflow-step">
                    <div class="step-number">📓</div>
                    <div class="step-content">
                        <h3>Jupyter Notebook</h3>
                        <p>Complete Python script that generates GDS, runs parameter sweeps, and plots S-parameters. 
                        Fully documented with markdown explanations.</p>
                    </div>
                </div>
                
                <div class="workflow-step">
                    <div class="step-number">📊</div>
                    <div class="step-content">
                        <h3>Transmission Plots</h3>
                        <p>Annotated figures showing Q-factor, extinction ratio, and FSR. 
                        Include both simulation results and fitted analytical models.</p>
                    </div>
                </div>
                
                <div class="workflow-step">
                    <div class="step-number">📄</div>
                    <div class="step-content">
                        <h3>Technical Report</h3>
                        <p>One-page PDF summarizing specifications, field snapshots, and fit results. 
                        Professional format suitable for portfolio or technical review.</p>
                    </div>
                </div>
                
                <div class="workflow-step">
                    <div class="step-number">👁️</div>
                    <div class="step-content">
                        <h3>Eye Diagram Analysis</h3>
                        <p>(Extra Credit) PIC-level eye-diagram comparing NRZ link performance 
                        with and without the filter block.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Learning Resources -->
    <section style="background: rgba(255, 255, 255, 0.02);">
        <div class="container">
            <h2>Learning Resources</h2>
            
            <div class="card-grid">
                <div class="card">
                    <i class="fas fa-flask card-icon"></i>
                    <h3>AIM Photonics Virtual Lab</h3>
                    <p>Browser-based applets for ring resonators and MZIs. Great for building 
                    intuition before diving into code.</p>
                    <a href="https://www.aimphotonics.com/virtual-lab" target="_blank" 
                       style="color: #4fc3f7; text-decoration: none;">
                        Explore Virtual Lab →
                    </a>
                </div>
                
                <div class="card">
                    <i class="fas fa-graduation-cap card-icon"></i>
                    <h3>Ansys Lumerical Tutorials</h3>
                    <p>Traveling-wave MZM tutorial shows end-to-end multi-physics setup. 
                    Same workflow applies to ring resonators.</p>
                    <a href="https://optics.ansys.com/hc/en-us/articles/360042305694" target="_blank" 
                       style="color: #4fc3f7; text-decoration: none;">
                        View Tutorial →
                    </a>
                </div>
                
                <div class="card">
                    <i class="fas fa-code-branch card-icon"></i>
                    <h3>Open PDKs & Examples</h3>
                    <p>ResearchGate thread links several open PDKs compatible with Meep/gdsfactory. 
                    Simulate realistic foundry layers!</p>
                    <a href="https://github.com/gdsfactory/awesome-photonics" target="_blank" 
                       style="color: #4fc3f7; text-decoration: none;">
                        Browse Resources →
                    </a>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Timeline -->
    <section>
        <div class="container">
            <h2>Weekend Project Timeline</h2>
            
            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-content">
                        <h3>Friday Evening</h3>
                        <p>Setup tools, create initial layout, run mode solver checks</p>
                    </div>
                </div>
                
                <div class="timeline-item">
                    <div class="timeline-content">
                        <h3>Saturday Morning</h3>
                        <p>FDTD parameter sweeps, optimize gap & radius</p>
                    </div>
                </div>
                
                <div class="timeline-item">
                    <div class="timeline-content">
                        <h3>Saturday Afternoon</h3>
                        <p>Extract metrics, build compact model, validate</p>
                    </div>
                </div>
                
                <div class="timeline-item">
                    <div class="timeline-content">
                        <h3>Sunday Morning</h3>
                        <p>Circuit-level verification, eye diagram analysis</p>
                    </div>
                </div>
                
                <div class="timeline-item">
                    <div class="timeline-content">
                        <h3>Sunday Afternoon</h3>
                        <p>Documentation, create report, optional extensions</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <script>
        // Three.js Photonics Animation
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ 
            canvas: document.getElementById('photonics-animation'),
            alpha: true,
            antialias: true
        });
        
        renderer.setSize(window.innerWidth, window.innerHeight);
        
        // Create ring geometry
        const ringGeometry = new THREE.TorusGeometry(2, 0.1, 16, 100);
        const ringMaterial = new THREE.MeshPhongMaterial({ 
            color: 0x4fc3f7,
            emissive: 0x4fc3f7,
            emissiveIntensity: 0.3,
            shininess: 100
        });
        const ring = new THREE.Mesh(ringGeometry, ringMaterial);
        scene.add(ring);
        
        // Create waveguide
        const waveguideGeometry = new THREE.BoxGeometry(8, 0.1, 0.1);
        const waveguideMaterial = new THREE.MeshPhongMaterial({ 
            color: 0x81c784,
            emissive: 0x81c784,
            emissiveIntensity: 0.2
        });
        const waveguide = new THREE.Mesh(waveguideGeometry, waveguideMaterial);
        waveguide.position.y = -2.2;
        scene.add(waveguide);
        
        // Add lights
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
        scene.add(ambientLight);
        
        const pointLight = new THREE.PointLight(0xffffff, 1);
        pointLight.position.set(5, 5, 5);
        scene.add(pointLight);
        
        // Create light pulses
        const pulseGeometry = new THREE.SphereGeometry(0.05, 16, 16);
        const pulseMaterial = new THREE.MeshBasicMaterial({ 
            color: 0xffff00,
            transparent: true,
            opacity: 0.8
        });
        
        const pulses = [];
        for (let i = 0; i < 20; i++) {
            const pulse = new THREE.Mesh(pulseGeometry, pulseMaterial.clone());
            pulse.userData = {
                angle: Math.random() * Math.PI * 2,
                speed: 0.02 + Math.random() * 0.02,
                inRing: Math.random() > 0.5,
                phase: Math.random() * Math.PI * 2
            };
            scene.add(pulse);
            pulses.push(pulse);
        }
        
        camera.position.z = 8;
        camera.position.y = 2;
        camera.lookAt(0, 0, 0);
        
        function animate() {
            requestAnimationFrame(animate);
            
            // Rotate ring slowly
            ring.rotation.y += 0.005;
            
            // Animate pulses
            pulses.forEach(pulse => {
                if (pulse.userData.inRing) {
                    // Circulate in ring
                    pulse.userData.angle += pulse.userData.speed;
                    pulse.position.x = Math.cos(pulse.userData.angle) * 2;
                    pulse.position.z = Math.sin(pulse.userData.angle) * 2;
                    pulse.position.y = 0;
                    
                    // Coupling probability
                    if (Math.abs(pulse.position.y + 2.2) < 0.3 && Math.random() < 0.01) {
                        pulse.userData.inRing = false;
                        pulse.userData.direction = pulse.position.x > 0 ? 1 : -1;
                    }
                } else {
                    // Move along waveguide
                    pulse.position.x += pulse.userData.speed * 2 * (pulse.userData.direction || 1);
                    pulse.position.y = -2.2;
                    pulse.position.z = 0;
                    
                    // Reset at edges
                    if (Math.abs(pulse.position.x) > 5) {
                        pulse.position.x = -5 * (pulse.userData.direction || 1);
                        pulse.userData.inRing = Math.random() > 0.7;
                    }
                    
                    // Coupling into ring
                    if (Math.abs(pulse.position.x) < 0.3 && Math.random() < 0.02) {
                        pulse.userData.inRing = true;
                        pulse.userData.angle = 0;
                    }
                }
                
                // Pulsing effect
                pulse.material.opacity = 0.5 + 0.3 * Math.sin(pulse.userData.phase + Date.now() * 0.005);
            });
            
            renderer.render(scene, camera);
        }
        
        animate();
        
        // Handle window resize
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
        
        // Ring Design Visualization
        const ringDesignData = {
            x: [],
            y: [],
            mode: 'lines',
            line: { color: '#4fc3f7', width: 3 },
            name: 'Ring'
        };
        
        const busData = {
            x: [-10, 10],
            y: [-7.45, -7.45],
            mode: 'lines',
            line: { color: '#81c784', width: 3 },
            name: 'Bus Waveguide'
        };
        
        // Generate ring points
        for (let i = 0; i <= 360; i += 5) {
            const angle = i * Math.PI / 180;
            ringDesignData.x.push(7 * Math.cos(angle));
            ringDesignData.y.push(7 * Math.sin(angle));
        }
        
        const ringLayout = {
            title: {
                text: 'Ring Resonator Layout (radius = 7µm, gap = 0.15µm)',
                font: { color: '#e0e0e0' }
            },
            xaxis: {
                title: 'X (µm)',
                gridcolor: '#333',
                zerolinecolor: '#666',
                tickfont: { color: '#888' },
                titlefont: { color: '#888' }
            },
            yaxis: {
                title: 'Y (µm)',
                gridcolor: '#333',
                zerolinecolor: '#666',
                tickfont: { color: '#888' },
                titlefont: { color: '#888' },
                scaleanchor: 'x',
                scaleratio: 1
            },
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            showlegend: true,
            legend: {
                font: { color: '#888' },
                bgcolor: 'rgba(0,0,0,0.5)'
            },
            annotations: [
                {
                    x: 0,
                    y: -3.5,
                    text: 'Gap = 0.15µm',
                    showarrow: true,
                    arrowhead: 2,
                    arrowsize: 1,
                    arrowwidth: 2,
                    arrowcolor: '#ff9800',
                    ax: 30,
                    ay: -30,
                    font: { color: '#ff9800', size: 14 }
                }
            ]
        };
        
        Plotly.newPlot('ring-design-viz', [ringDesignData, busData], ringLayout, {responsive: true});
        
        // Transmission Spectrum
        const wavelengths = [];
        const transmission = [];
        const drop = [];
        
        // Generate resonance data
        const centerWavelength = 1550;
        const fsr = 12.5; // nm
        const fwhm = 0.8; // nm
        
        for (let w = 1540; w <= 1560; w += 0.01) {
            wavelengths.push(w);
            
            // Multiple resonances
            let t = 1;
            let d = 0;
            
            for (let n = -2; n <= 2; n++) {
                const resonance = centerWavelength + n * fsr;
                const detuning = w - resonance;
                const lorentzian = 1 / (1 + (2 * detuning / fwhm) ** 2);
                
                t *= (1 - 0.95 * lorentzian);
                d += 0.95 * lorentzian;
            }
            
            transmission.push(t);
            drop.push(Math.min(d, 1));
        }
        
        const transmissionTrace = {
            x: wavelengths,
            y: transmission,
            type: 'scatter',
            mode: 'lines',
            name: 'Through Port',
            line: { color: '#4fc3f7', width: 2 }
        };
        
        const dropTrace = {
            x: wavelengths,
            y: drop,
            type: 'scatter',
            mode: 'lines',
            name: 'Drop Port',
            line: { color: '#81c784', width: 2 }
        };
        
        const spectrumLayout = {
            title: {
                text: 'Ring Resonator Transmission Spectrum',
                font: { color: '#e0e0e0' }
            },
            xaxis: {
                title: 'Wavelength (nm)',
                gridcolor: '#333',
                zerolinecolor: '#666',
                tickfont: { color: '#888' },
                titlefont: { color: '#888' }
            },
            yaxis: {
                title: 'Transmission',
                gridcolor: '#333',
                zerolinecolor: '#666',
                tickfont: { color: '#888' },
                titlefont: { color: '#888' },
                range: [0, 1.05]
            },
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)',
            showlegend: true,
            legend: {
                font: { color: '#888' },
                bgcolor: 'rgba(0,0,0,0.5)'
            },
            annotations: [
                {
                    x: 1550,
                    y: 0.05,
                    text: 'Q ≈ 1950<br>ER > 20dB',
                    showarrow: true,
                    arrowhead: 2,
                    arrowsize: 1,
                    arrowwidth: 2,
                    arrowcolor: '#ff9800',
                    ax: -50,
                    ay: -50,
                    font: { color: '#ff9800', size: 14 },
                    bgcolor: 'rgba(0,0,0,0.8)',
                    bordercolor: '#ff9800',
                    borderwidth: 1
                }
            ]
        };
        
        Plotly.newPlot('transmission-spectrum', [transmissionTrace, dropTrace], spectrumLayout, {responsive: true});
        
        // Design Space Exploration
        const radii = [];
        const gaps = [];
        const qFactors = [];
        
        // Generate design space data
        for (let r = 6; r <= 8; r += 0.1) {
            for (let g = 0.12; g <= 0.25; g += 0.01) {
                radii.push(r);
                gaps.push(g);
                
                // Simplified Q-factor model
                const kappa = Math.exp(-2 * g / 0.1);
                const Q_intrinsic = 50000;
                const Q_loaded = Q_intrinsic / (1 + kappa * Q_intrinsic);
                
                qFactors.push(Q_loaded);
            }
        }
        
        const designSpaceTrace = {
            x: radii,
            y: gaps,
            z: qFactors,
            type: 'scatter3d',
            mode: 'markers',
            marker: {
                size: 5,
                color: qFactors,
                colorscale: 'Viridis',
                showscale: true,
                colorbar: {
                    title: 'Q-Factor',
                    titlefont: { color: '#888' },
                    tickfont: { color: '#888' }
                }
            },
            text: qFactors.map(q => `Q = ${q.toFixed(0)}`),
            hovertemplate: 'Radius: %{x:.1f}µm<br>Gap: %{y:.3f}µm<br>%{text}<extra></extra>'
        };
        
        const designSpaceLayout = {
            title: {
                text: 'Design Space: Q-Factor vs Ring Parameters',
                font: { color: '#e0e0e0' }
            },
            scene: {
                xaxis: {
                    title: 'Radius (µm)',
                    gridcolor: '#333',
                    tickfont: { color: '#888' },
                    titlefont: { color: '#888' }
                },
                yaxis: {
                    title: 'Gap (µm)',
                    gridcolor: '#333',
                    tickfont: { color: '#888' },
                    titlefont: { color: '#888' }
                },
                zaxis: {
                    title: 'Q-Factor',
                    gridcolor: '#333',
                    tickfont: { color: '#888' },
                    titlefont: { color: '#888' }
                },
                bgcolor: 'rgba(0,0,0,0)',
                camera: {
                    eye: { x: 1.5, y: 1.5, z: 1.5 }
                }
            },
            paper_bgcolor: 'rgba(0,0,0,0)',
            plot_bgcolor: 'rgba(0,0,0,0)'
        };
        
        Plotly.newPlot('design-space', [designSpaceTrace], designSpaceLayout, {responsive: true});
        
        // MathJax Configuration
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>
</body>
</html>